#include "precompiled.h"


/*-----------------------------------------------------------------------------*
*
* File:   msg_notif_email
*
* Date:   1/22/2004
*
* Author: Eric Schmit
*
* PVCS KEYWORDS:
* ARCHIVE      :  $Archive$
* REVISION     :  $Revision: 1.7.4.1 $
* DATE         :  $Date: 2008/11/13 17:23:45 $
*
* Copyright (c) 1999, 2000, 2001, 2002 Cannon Technologies Inc. All rights reserved.
*-----------------------------------------------------------------------------*/

#include <iostream>
#include <iomanip>
using namespace std;  // get the STL into our namespace for use.  Do NOT use iostream.h anymore

#include "utility.h"
#include "msg_notif_email.h"

RWDEFINE_COLLECTABLE( CtiNotifEmailMsg, NOTIF_EMAIL_MSG_ID );


//=====================================================================================================================
//=====================================================================================================================

CtiNotifEmailMsg::CtiNotifEmailMsg() :
_notifGroupID(0), _notifAttachment(0)
{

}

//=====================================================================================================================
//=====================================================================================================================

CtiNotifEmailMsg::~CtiNotifEmailMsg()
{
    delete_container( _attachments );
    _attachments.clear();
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::saveGuts( RWvostream &aStream ) const
{
   CtiMessage::saveGuts( aStream );

   aStream << _to
            << _notifGroupID
            << _subject
            << _body
            << _toCC
            << _toBCC
            << _attachments;
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::restoreGuts( RWvistream& aStream )
{
   CtiMessage::restoreGuts( aStream );

   aStream >> _to
            >> _notifGroupID
            >> _subject
            >> _body
            >> _toCC
            >> _toBCC
            >> _attachments;
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::dump() const
{
   CtiLockGuard<CtiLogger> doubt_guard(dout);

   dout << " ------- Message ------- " << isA() << endl;
   dout << "Notification Group ID    " << _notifGroupID << endl;
   dout << "To                       " << _to << endl;
   dout << "Subject                  " << _subject << endl;
   dout << "CC                       " << _toCC << endl;
   dout << "BCC                      " << _toBCC << endl;
}

//=====================================================================================================================
//=====================================================================================================================

std::vector<CtiNotifEmailAttachmentMsg*>& CtiNotifEmailMsg::getAttachments( void )
{
   return( _attachments );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setAttachment( string file )
{
   _notifAttachment = new CtiNotifEmailAttachmentMsg( file );
   _notifAttachment->dump();
   _attachments.push_back( _notifAttachment );
}

//=====================================================================================================================
//=====================================================================================================================

int CtiNotifEmailMsg::getNotifGroupId( void )
{
   return( _notifGroupID );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setNotifGroupId( int id )
{
   _notifGroupID = id;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiNotifEmailMsg::getTo( void )
{
   return( _to );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setTo( string to )
{
   _to = to;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiNotifEmailMsg::getSubject( void )
{
   return( _subject );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setSubject( string sub )
{
   _subject = sub;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiNotifEmailMsg::getBody( void )
{
   return( _body );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setBody( string body )
{
   _body = body;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiNotifEmailMsg::getToCC( void )
{
   return( _toCC );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setToCC( string toCC )
{
   _toCC = toCC;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiNotifEmailMsg::getToBCC( void )
{
   return( _toBCC );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiNotifEmailMsg::setToBCC( string toBCC )
{
   _toBCC = toBCC;
}

//=====================================================================================================================
// Return a new'ed copy of this message!
//=====================================================================================================================

CtiMessage* CtiNotifEmailMsg::replicateMessage() const
{
   CtiNotifEmailMsg *ret = CTIDBG_new CtiNotifEmailMsg( *this );

   return( ( CtiMessage*)ret );
}

/* Start of deprecated email msg*/

RWDEFINE_COLLECTABLE( CtiCustomerNotifEmailMsg, NOTIF_CUST_EMAIL_MSG_ID );


//=====================================================================================================================
//=====================================================================================================================

CtiCustomerNotifEmailMsg::CtiCustomerNotifEmailMsg() :
_customerID(0), _notifAttachment(0)
{

}

//=====================================================================================================================
//=====================================================================================================================

CtiCustomerNotifEmailMsg::~CtiCustomerNotifEmailMsg()
{
   _attachments.clearAndDestroy();
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::saveGuts( RWvostream &aStream ) const
{
   CtiMessage::saveGuts( aStream );

   aStream << _to
            << _customerID
            << _subject
            << _body
            << _toCC
            << _toBCC
            << _attachments;
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::restoreGuts( RWvistream& aStream )
{
   CtiMessage::restoreGuts( aStream );

   aStream >> _to
            >> _customerID
            >> _subject
            >> _body
            >> _toCC
            >> _toBCC
            >> _attachments;
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::dump() const
{
   CtiLockGuard<CtiLogger> doubt_guard(dout);

   dout << " ------- Message ------- " << isA() << endl;
   dout << "Customer ID              " << _customerID << endl;
   dout << "To                       " << _to << endl;
   dout << "Subject                  " << _subject << endl;
   dout << "CC                       " << _toCC << endl;
   dout << "BCC                      " << _toBCC << endl;
}

//=====================================================================================================================
//=====================================================================================================================

RWOrdered& CtiCustomerNotifEmailMsg::getAttachments( void )
{
   return( _attachments );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setAttachment( string file )
{
   _notifAttachment = new CtiNotifEmailAttachmentMsg( file );
   _notifAttachment->dump();
   _attachments.insert( _notifAttachment );
}

//=====================================================================================================================
//=====================================================================================================================

int CtiCustomerNotifEmailMsg::getCustomerId( void )
{
   return( _customerID );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setCustomerId( int id )
{
   _customerID = id;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiCustomerNotifEmailMsg::getTo( void )
{
   return( _to );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setTo( string to )
{
   _to = to;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiCustomerNotifEmailMsg::getSubject( void )
{
   return( _subject );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setSubject( string sub )
{
   _subject = sub;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiCustomerNotifEmailMsg::getBody( void )
{
   return( _body );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setBody( string body )
{
   _body = body;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiCustomerNotifEmailMsg::getToCC( void )
{
   return( _toCC );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setToCC( string toCC )
{
   _toCC = toCC;
}

//=====================================================================================================================
//=====================================================================================================================

string CtiCustomerNotifEmailMsg::getToBCC( void )
{
   return( _toBCC );
}

//=====================================================================================================================
//=====================================================================================================================

void CtiCustomerNotifEmailMsg::setToBCC( string toBCC )
{
   _toBCC = toBCC;
}

//=====================================================================================================================
// Return a new'ed copy of this message!
//=====================================================================================================================

CtiMessage* CtiCustomerNotifEmailMsg::replicateMessage() const
{
   CtiCustomerNotifEmailMsg *ret = CTIDBG_new CtiCustomerNotifEmailMsg( *this );

   return( ( CtiMessage*)ret );
}



