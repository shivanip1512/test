#include <boost/test/unit_test.hpp>

#include "dnp_datalink_packet.h"

#include "boost_test_helpers.h"

#include <boost/assign/list_of.hpp>

BOOST_AUTO_TEST_SUITE( test_dnp_datalink_packet )

BOOST_AUTO_TEST_CASE( test_calcPacketLength )
{
    using Cti::Protocols::DNP::DatalinkPacket::calcPacketLength;

    const std::vector<unsigned> expected = boost::assign::list_of
        (  0)(  0)(  0)(  0)(  0)
        ( 10)
        ( 13)( 14)( 15)( 16)( 17)( 18)( 19)( 20)( 21)( 22)( 23)( 24)( 25)( 26)( 27)( 28)
        ( 31)( 32)( 33)( 34)( 35)( 36)( 37)( 38)( 39)( 40)( 41)( 42)( 43)( 44)( 45)( 46)
        ( 49)( 50)( 51)( 52)( 53)( 54)( 55)( 56)( 57)( 58)( 59)( 60)( 61)( 62)( 63)( 64)
        ( 67)( 68)( 69)( 70)( 71)( 72)( 73)( 74)( 75)( 76)( 77)( 78)( 79)( 80)( 81)( 82)
        ( 85)( 86)( 87)( 88)( 89)( 90)( 91)( 92)( 93)( 94)( 95)( 96)( 97)( 98)( 99)(100)
        (103)(104)(105)(106)(107)(108)(109)(110)(111)(112)(113)(114)(115)(116)(117)(118)
        (121)(122)(123)(124)(125)(126)(127)(128)(129)(130)(131)(132)(133)(134)(135)(136)
        (139)(140)(141)(142)(143)(144)(145)(146)(147)(148)(149)(150)(151)(152)(153)(154)
        (157)(158)(159)(160)(161)(162)(163)(164)(165)(166)(167)(168)(169)(170)(171)(172)
        (175)(176)(177)(178)(179)(180)(181)(182)(183)(184)(185)(186)(187)(188)(189)(190)
        (193)(194)(195)(196)(197)(198)(199)(200)(201)(202)(203)(204)(205)(206)(207)(208)
        (211)(212)(213)(214)(215)(216)(217)(218)(219)(220)(221)(222)(223)(224)(225)(226)
        (229)(230)(231)(232)(233)(234)(235)(236)(237)(238)(239)(240)(241)(242)(243)(244)
        (247)(248)(249)(250)(251)(252)(253)(254)(255)(256)(257)(258)(259)(260)(261)(262)
        (265)(266)(267)(268)(269)(270)(271)(272)(273)(274)(275)(276)(277)(278)(279)(280)
        (283)(284)(285)(286)(287)(288)(289)(290)(291)(292);

    std::vector<unsigned> results;

    for( unsigned i = 0; i < 256; ++i )
    {
        results.push_back(calcPacketLength(i));
    }

    BOOST_CHECK_EQUAL_RANGES(expected, results);

}

BOOST_AUTO_TEST_SUITE_END()
