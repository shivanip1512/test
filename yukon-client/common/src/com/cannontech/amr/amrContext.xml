<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd">

    <bean id="moveInMoveOutEmailService"
        class="com.cannontech.amr.moveInMoveOut.service.impl.MoveInMoveOutEmailServiceImpl">
        <property name="emailService" ref="emailService" />
        <property name="pointFormattingService"
            ref="pointFormattingService" />
            
        <property name="moveInSuccessEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveInSuccessEmail.tmp" />
        <property name="moveInScheduledEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveInScheduledEmail.tmp" />
        <property name="moveInFailedEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveInFailedEmail.tmp" />

        <property name="moveOutSuccessEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveOutSuccessEmail.tmp" />
        <property name="moveOutScheduledEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveOutScheduledEmail.tmp" />
        <property name="moveOutFailedEmail" value="classpath:com/cannontech/amr/moveInMoveOut/service/templates/moveOutFailedEmail.tmp" />
           
    </bean>

    <bean id="moveInMoveOutService"
        class="com.cannontech.amr.moveInMoveOut.service.impl.MoveInMoveOutServiceImpl">

        <property name="jobManager" ref="jobManager" />
        <property name="moveInDefinition" ref="moveInJob" />
        <property name="moveOutDefinition" ref="moveOutJob" />

        <property name="authDao" ref="authDao" />
        <property name="calculatedPointService"
            ref="calculatedPointService" />
        <property name="deviceGroupEditorDao" ref="deviceGroupEditorDao" />
        <property name="deviceGroupDao" ref="deviceGroupDao" />
        <property name="deviceGroupMemberEditorDao"
            ref="deviceGroupMemberEditorDao" />
        <property name="dynamicDataSource" ref="dynamicDataSource" />
        <property name="jdbcTemplate" ref="simpleJdbcTemplate" />
        <property name="meterDao" ref="meterDao" />
        <property name="nextValueHelper" ref="nextValueHelper"/>
        <property name="paoCommandAuthorizationService" ref="paoCommandAuthorizationService" />
        <property name="meterReadService" ref="meterReadService" />
        <property name="attributeService" ref="attributeService" />
    </bean>

    <!-- Moving JobDefinitions -->
    <bean id="moveInJob"
        class="com.cannontech.jobs.support.SimpleYukonJobDefinition">
        <property name="taskName">
            <idref local="moveInTask" />
        </property>
        <property name="title" value="Move In Job" />
        <property name="inputs">
            <bean class="com.cannontech.web.input.InputRoot">
                <property name="inputList">
                    <list>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="meter" />
                            <property name="displayName" value="Meter" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.MeterType">
                                    <property name="meterDao"
                                        ref="meterDao" />
                                </bean>
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field"
                                value="newMeterNumber" />
                            <property name="displayName"
                                value="New Meter Number" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="newMeterName" />
                            <property name="displayName"
                                value="New Meter Name" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="emailAddress" />
                            <property name="displayName"
                                value="Email Address" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="moveInDate" />
                            <property name="displayName"
                                value="Move In Date" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.DateType" />
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <bean id="moveOutJob"
        class="com.cannontech.jobs.support.SimpleYukonJobDefinition">
        <property name="taskName">
            <idref local="moveOutTask" />
        </property>
        <property name="title" value="Move Out Job" />
        <property name="inputs">
            <bean class="com.cannontech.web.input.InputRoot">
                <property name="inputList">
                    <list>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="meter" />
                            <property name="displayName" value="Meter" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.MeterType">
                                    <property name="meterDao"
                                        ref="meterDao" />
                                </bean>
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="emailAddress" />
                            <property name="displayName"
                                value="Email Address" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="moveOutDate" />
                            <property name="displayName"
                                value="Move Out Date" />
                            <property name="type">
                                <bean
                                    class="com.cannontech.web.input.type.DateType" />
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>

    <!--  Moving Tasks -->
    <bean id="moveInTask"
        class="com.cannontech.amr.moveInMoveOut.tasks.MoveInTask"
        scope="prototype">
        <property name="moveInMoveOutService"
            ref="moveInMoveOutService" />
        <property name="moveInMoveOutEmailService"
            ref="moveInMoveOutEmailService" />
    </bean>

    <bean id="moveOutTask"
        class="com.cannontech.amr.moveInMoveOut.tasks.MoveOutTask"
        scope="prototype">
        <property name="moveInMoveOutService"
            ref="moveInMoveOutService" />
        <property name="moveInMoveOutEmailService"
            ref="moveInMoveOutEmailService" />
    </bean>
    
    
    <!-- Toggle Profiling Service -->
    <bean id="toggleProfilingService"
        class="com.cannontech.amr.toggleProfiling.service.impl.ToggleProfilingServiceImpl">
        <property name="paoDao" ref="paoDao" />
        <property name="dbPersistentDao" ref="dbPersistentDao" />
        <property name="jobManager" ref="jobManager" />
        <property name="toggleProfilingDefinition" ref="toggleProfilingJob" />
        
    </bean>
    
    
    <!-- Toggle Profiling Job Definition -->
    <bean id="toggleProfilingJob" class="com.cannontech.jobs.support.SimpleYukonJobDefinition">
        <property name="taskName">
            <idref local="toggleProfilingTask" />
        </property>
        <property name="title" value="Toggle Profiling Job" />
        <property name="inputs">
            <bean class="com.cannontech.web.input.InputRoot">
                <property name="inputList">
                    <list>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="deviceId" />
                            <property name="displayName" value="Device ID" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.IntegerType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="newToggleVal" />
                            <property name="displayName" value="New Toggle Value" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.BooleanType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="channelNum" />
                            <property name="displayName" value="Channel Number" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.IntegerType" />
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>
    
    <!--  Toggle Profiling Task -->
    <bean id="toggleProfilingTask" 
        class="com.cannontech.amr.toggleProfiling.tasks.ToggleProfilingTask"  
        scope="prototype">
        <property name="paoDao" ref="paoDao" />
        <property name="dbPersistentDao" ref="dbPersistentDao" />
    </bean>
    
    <!-- Scheduled Group Request Execution Job Definition -->
    <bean id="scheduledGroupRequestExecutionJobDefinition" class="com.cannontech.jobs.support.SimpleYukonJobDefinition">
        <property name="taskName">
            <idref local="scheduledGroupRequestExecutionTask" />
        </property>
        <property name="title" value="Scheduled Group Request Execution Job" />
        <property name="inputs">
            <bean class="com.cannontech.web.input.InputRoot">
                <property name="inputList">
                    <list>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="name" />
                            <property name="displayName" value="Name" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="deviceGroup" />
                            <property name="displayName" value="Device Group" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.DeviceGroupType" />
                            </property>
                        </bean>
                        <bean class="com.cannontech.web.input.InputBase">
                            <property name="field" value="attributes" />
                            <property name="displayName" value="Attributes" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.AttributeSetType" />
                            </property>
                        </bean>
                        <bean
                            class="com.cannontech.web.input.InputBase">
                            <property name="field" value="command" />
                            <property name="displayName" value="Command" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.StringType" />
                            </property>
                        </bean>
                        <bean class="com.cannontech.web.input.InputBase">
                            <property name="field" value="commandRequestExecutionType" />
                            <property name="displayName" value="Command Request Execution Type" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.CommandRequestExecutionTypeType" />
                            </property>
                        </bean>
                        <bean class="com.cannontech.web.input.InputBase">
                            <property name="field" value="retryCount" />
                            <property name="displayName" value="Retry Count" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.IntegerType" />
                            </property>
                        </bean>
                        <bean class="com.cannontech.web.input.InputBase">
                            <property name="field" value="turnOffQueuingAfterRetryCount" />
                            <property name="displayName" value="Turn Off Queuing After Retry Count" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.IntegerType" />
                            </property>
                        </bean>
                        <bean class="com.cannontech.web.input.InputBase">
                            <property name="field" value="stopRetryAfterHoursCount" />
                            <property name="displayName" value="Stop Retry After Hours Count" />
                            <property name="type">
                                <bean class="com.cannontech.web.input.type.IntegerType" />
                            </property>
                        </bean>
                    </list>
                </property>
            </bean>
        </property>
    </bean>
    
    <!-- Scheduled Group Request Execution Task -->
    <bean id="scheduledGroupRequestExecutionTask" 
        class="com.cannontech.amr.scheduledGroupRequestExecution.tasks.ScheduledGroupRequestExecutionTask"  
        scope="prototype">
    </bean>
    
    
    
    <!-- Scheduled Group Request Execution Service -->
    <bean id="scheduledGroupRequestExecutionService" 
        class="com.cannontech.amr.scheduledGroupRequestExecution.service.impl.ScheduledGroupRequestExecutionServiceImpl"  
        scope="prototype">
    </bean>
    
    <!-- Scheduled Group Command Execution Results Dao -->
    <bean id="scheduledGroupRequestExecutionDao" 
        class="com.cannontech.amr.scheduledGroupRequestExecution.dao.impl.ScheduledGroupRequestExecutionDaoImpl"  
        scope="prototype">
    </bean>
	
    <!-- Phase Detect Service -->
    <bean id="phaseDetectResultsCache" class="com.cannontech.common.util.RecentResultsCache"/>
    
    <bean id="phaseDetectService" class="com.cannontech.amr.phaseDetect.service.impl.PhaseDetectServiceImpl">
        <property name="phaseDetectResultsCache" ref="phaseDetectResultsCache"/>
    </bean>
    
    <!-- CRF Meter Read Service -->
    <bean id="crfMeterReadService" class="com.cannontech.amr.crf.service.CrfMeterReadService">
        <property name="connectionFactory" ref="connectionFactoryTarget"/>
    </bean>
    
</beans>