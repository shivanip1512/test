<%@ taglib prefix="cti" uri="http://cannontech.com/tags/cti"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>
<%@ taglib prefix="tags" tagdir="/WEB-INF/tags"%>

<div id="demandResponse" class="devWidget">
    <cti:flashScopeMessages />
    <div class="widgetMessage"></div>
    <div class="notes">
        <b>Program</b> - Program to clone<br/>
        <b>Template</b> - example: entry of "Eaton Cloud" will create Eaton Cloud Program 1, Eaton Cloud Program 2, Eaton Cloud Control Area 1 ...<br/>
        <b># of Scenarios/Control Areas/Programs</b> - Number of objects to create<br/>
        <b># of Devices</b> - Number of Devices to enroll, each account can have maximum of 3 devices enrolled<br/>
        <b>Device Types</b> - Device Type(s) to enroll<br/>
        <span class="error">
            Make sure your program setup for the program you plan to clone works. 
            Enroll one device for each device type you plan to select manually. 
            Make sure that <a href="<cti:url value="/admin/config/edit?category=WEB_SERVER"/>">Yukon External URL</a> does not include localhost or 127.0.0.1.<br/>
            <cti:icon icon="icon-error"/><b>Backup your database!!</b>
        </span><br/>
        <div class="MT20"><cti:button label="Don't Press" classes="delete js-run-clean"/></div>
        <a href="javascript:void(0);" class="dib" title="WHY NOT?!">
            <cti:icon icon="icon-help" data-popup="#demand-response-clean-help" classes="ML0"/>
        </a>
        <div id="demand-response-clean-help" title="About Demand Response Setup Clean" data-width="500" class="dn">
            <h3>Why shouldn't I click this?</h3>
            <p>Good question!</p>
            <p>This button will attempt to clean up your database, which might not work as expected. A database restore is suggested.
        </div>
    </div>
    <form:form modelAttribute="devDemandResponse" action="setupDemandResponse" method="post" id="setupDemandResponseForm">
        <cti:csrfToken/>
        <div class="widgetContent" style="width:60%">
            <tags:hidden path="clean" id="runClean"/>
            <tags:nameValueContainer>
                <tags:nameValue name="Program">
                    <tags:selectWithItems items="${allPrograms}" path="programId" itemValue="liteID"/>
                </tags:nameValue>
                <tags:nameValue name="Template">
                    <tags:input path="templateName"/>
                </tags:nameValue>
                <tags:nameValue name="# of Scenarios">
                    <tags:input path="scenarios" size="2"/>
                </tags:nameValue>
                <tags:nameValue name="# of Control Areas">
                    <tags:input path="controlAreas" size="2"/>
                </tags:nameValue>
                <tags:nameValue name="# of Programs">
                    <tags:input path="programs" size="2"/>
                </tags:nameValue>
                <tags:nameValue name="# of Devices">
                    <tags:input path="devices" size="2"/>
                </tags:nameValue>
                <tags:nameValue name="Device Types">
                    <tags:selectWithItems items="${drPaoTypes}" path="types" dataPlaceholder="Select Device Types" inputClass="js-selected-device-types js-init-chosen w300"/>
                </tags:nameValue>
                <tags:nameValue name="# of Devices in System with Selected Device Type(s)">
                    <span class="js-num-devices">${numDevices}</span>
                </tags:nameValue>
                <tags:nameValue name="# of Accounts in System">
                    ${numAccounts}
                </tags:nameValue>
            </tags:nameValueContainer>
        </div>
        <div class="page-action-area">
            <cti:button nameKey="runSetup" classes="action primary js-run-setup"/>
        </div>
    </form:form>
</div>

<script>
	$('.js-init-chosen').chosen();
</script>
