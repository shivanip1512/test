<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
       http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
       http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">
	
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
        <property name="cacheSeconds" value="0"/>
        <property name="customArgumentResolvers">
            <list>
                <ref bean="deviceCollectionFactory"/>
                <ref bean="inventoryCollectionFactory"/>
                <ref bean="userContextArgumentResolver"/>
                <ref bean="flashScopeArgumentResolver"/>
                <ref bean="accountInfoFragmentArgumentResolver"/>
                <ref bean="energyCompanyInfoFragmentArgumentResolver"/>
                <ref bean="enumArgumentResolver"/>
            </list>
        </property>
    </bean>
    
    <bean class="org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"/>
    <bean class="org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter"/>

    <bean id="webSecurityInterceptor" class="com.cannontech.web.security.WebSecurityInterceptor"/>

    <bean id="webSecurityAnnotationProcessor" class="com.cannontech.web.security.WebSecurityAnnotationProcessor"/>
    
    <bean id="webSecurityChecker" class="com.cannontech.web.security.WebSecurityChecker"/>
    
    <bean id="multipartResolver" class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
        <property name="maxUploadSize" value="-1"/> <!-- no limit -->
    </bean>
    
    <bean id="userContextArgumentResolver" class="com.cannontech.web.login.UserContextArgumentResolver"/>
    <bean id="enumArgumentResolver" class="com.cannontech.web.login.EnumArgumentResolver"/>
    
    <!-- If we want the view resolver to continue to not jave the suffix, we'll need this. -->
    <bean id="viewNameTranslator" class="org.springframework.web.servlet.view.DefaultRequestToViewNameTranslator">
        <property name="suffix" value=".jsp"/>
    </bean>
    
    <bean id="themeResolver" class="com.cannontech.web.i18n.YukonGroupThemeResolver">
        <property name="defaultThemeName" value="default"/>
    </bean>
    
    <!-- This is required because WebApplicationContexts only look locally for a bean named "themeSource" -->
    <bean id="themeSource" class="org.springframework.ui.context.support.DelegatingThemeSource">
        <property name="parentThemeSource" ref="mainThemeSource"/>
    </bean>
    
    <bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver"/>
    
    <bean id="userContextResolver" class="com.cannontech.web.util.YukonUserContextConstructor">
        <property name="authDao" ref="authDao"/>
        <property name="defaultThemeResolver" ref="themeResolver"/>
    </bean>

    <bean id="timerTaskUtil" class="com.cannontech.stars.web.util.TimerTaskUtil">
      <property name="timer" ref="globalScheduledExecutor"/>
    </bean>
    
    <bean id="menuBuilder" class="com.cannontech.web.menu.CommonModuleBuilder" init-method="processConfigFile">
        <constructor-arg value="/WEB-INF/module_config.xml"/>
        <property name="menuOptionProducerFactory">
            <bean class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean">
                <property name="serviceLocatorInterface" value="com.cannontech.web.menu.option.producer.MenuOptionProducerFactory" />
            </bean>
        </property>
        <property name="searchProducerFactory">
            <bean class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean">
                <property name="serviceLocatorInterface" value="com.cannontech.web.menu.option.producer.SearchProducerFactory" />
            </bean>
        </property>
    </bean>
    
    <!-- Search Producers -->
    <bean id="operatorAccountSearchProducer" class="com.cannontech.web.menu.option.producer.OperatorAccountSearchProducer"/>
    <bean id="amrSearchProducer" class="com.cannontech.web.menu.option.producer.MeteringSearchProducer"/>
    <bean id="drSearchProducer" class="com.cannontech.web.menu.option.producer.DrSearchProducer"/>
    <bean id="capControlSearchProducer" class="com.cannontech.web.menu.option.producer.CapControlSearchProducer"/>
    
    <bean id="widgetInput.deviceId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="deviceId"/>
        <property name="description" value="the id of the Yukon device"/>
        <property name="required" value="true"/>
    </bean>
    
    <bean id="widgetInput.pointId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="pointId"/>
        <property name="description" value="the id of the Yukon point"/>
        <property name="required" value="true"/>
    </bean>

    <bean id="widgetInput.constraint" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="constraint"/>
        <property name="description" value="a FQN for a lucene searcher constaint"/>
        <property name="required" value="true"/>
    </bean>

    <bean id="widgetInput.permission" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="permission"/>
        <property name="description" value="the name of one of the Permission enums"/>
        <property name="required" value="true"/>
    </bean>

    <bean id="widgetInput.permissionAllow" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="allow"/>
        <property name="description" value="whether this permission is being allowed or denied"/>
        <property name="required" value="true"/>
    </bean>

    <bean id="widgetInput.groupId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="groupId"/>
        <property name="description" value="the id of ta Yukon user group"/>
        <property name="required" value="true"/>
    </bean>

    <bean id="widgetInput.userId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="userId"/>
        <property name="description" value="the id of a Yukon user"/>
        <property name="required" value="true"/>
    </bean>
    
    <bean id="widgetInput.operatorAccountSearchSearchBy" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="searchBy"/>
        <property name="description" value="Search type. See com.cannontech.stars.dr.general.model.OperatorAccountSearchBy"/>
        <property name="required" value="false"/>
    </bean>
    
    <bean id="widgetInput.operatorAccountSearchSearchValue" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="searchValue"/>
        <property name="description" value="value to search for"/>
        <property name="required" value="false"/>
    </bean>
    
    <bean id="widgetInput.accountId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="accountId"/>
        <property name="description" value="stars account id"/>
        <property name="required" value="true"/>
    </bean>
    
    <bean id="widgetInput.energyCompanyId" class="com.cannontech.web.widget.support.SimpleWidgetInput">
        <property name="name" value="widgetInput.energyCompanyId"/>
        <property name="description" value="stars widgetInput.energyCompany id"/>
        <property name="required" value="true"/>
    </bean>
    
    <bean id="meterSearchWidget"
    	class="com.cannontech.web.widget.MeterSearchWidget">
    	<property name="title" value="Meter Search" />
    	<property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
    </bean>

    <bean id="accountInformationWidget"
    	class="com.cannontech.web.widget.AccountInformationWidget">
    	<property name="identityPath" value="common/deviceIdentity.jsp" />
    	<property name="title" value="CIS Information" />
    	<property name="lazyLoad" value="true" />
    	<property name="inputs">
    		<set>
    			<ref local="widgetInput.deviceId" />
    		</set>
    	</property>
    	<property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
    </bean>
    
    <bean id="cayentaAccountInformationWidget"
    	class="com.cannontech.web.widget.CayentaAccountInformationWidget">
    	<property name="identityPath" value="common/deviceIdentity.jsp" />
    	<property name="title" value="CIS Information (Cayenta)" />
    	<property name="lazyLoad" value="true" />
    	<property name="inputs">
    		<set>
    			<ref local="widgetInput.deviceId" />
    		</set>
    	</property>
    	<property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="CIS_DETAIL_WIDGET_ENABLED"/>
            </bean>
	   	</property>
    </bean>

	<bean id="deviceGroupWidget"
    	class="com.cannontech.web.widget.DeviceGroupWidget">
    	<property name="title" value="Device Groups"/>
    	<property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="deviceGroupDao" ref="deviceGroupDao"/>
        <property name="deviceGroupEditorDao" ref="deviceGroupEditorDao"/>
        <property name="deviceGroupMemberEditorDao" ref="deviceGroupMemberEditorDao"/>
        <property name="meterDao" ref="meterDao"/>
        <property name="deviceGroupService" ref="deviceGroupService"/>
    </bean>

	<bean id="touWidget"
    	class="com.cannontech.web.widget.TouWidget">
    	<property name="title" value="TOU"/>
    	<property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
    </bean>
    
    <bean id="configWidget"
        class="com.cannontech.web.widget.ConfigWidget">
        <property name="title" value="Device Configuration"/>
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
        </property>
        <property name="deviceConfigurationDao" ref="deviceConfigurationDao" />
        <property name="meterDao" ref="meterDao"/>
        <property name="deviceConfigService" ref="deviceConfigService"/>
        <property name="paoDefinitionDao" ref="paoDefinitionDao"/>
    </bean>

    <bean id="readCurrentTimeWidget"
    	class="com.cannontech.web.widget.ReadCurrentTimeWidget">
    	<property name="title" value="Get Current Time"/>
    </bean>
    
    <bean id="pointValueDisplayWidget"
    	class="com.cannontech.web.widget.PointValueDisplayWidget">
    	<property name="title" value="Point Value Widget"/>
        <property name="identityPath" value="common/pointIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.pointId"/>
           </set>
        </property>
        <property name="pointDao" ref="pointDao"/>
    </bean>

    <bean id="disconnectMeterWidget"
    	class="com.cannontech.web.widget.DisconnectMeterWidget">
    	<property name="title" value="Disconnect"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
		<property name="plcDeviceAttributeReadService" ref="plcDeviceAttributeReadService"/>
        <property name="attributeService" ref="attributeService"/>
        <property name="meterDao" ref="meterDao"/>
        <property name="stateDao" ref="stateDao"/>
        <property name="dynamicDataSource" ref="dynamicDataSource"/>
        <property name="commandRequestExecutor" ref="commandRequestDeviceExecutor"/>
        <property name="commandAuthorizationService" ref="paoCommandAuthorizationService" />
        <property name="deviceDao" ref="deviceDao" />
    </bean>
    
    <bean id="rfnMeterDisconnectWidget" class="com.cannontech.web.widget.RfnMeterDisconnectWidget">
        <property name="title" value="Disconnect"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
        </property>
    </bean>
    
    <bean id="meterOutagesWidget"
    	class="com.cannontech.web.widget.MeterOutagesWidget">
    	<property name="title" value="Outages"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="plcDeviceAttributeReadService" ref="plcDeviceAttributeReadService"/>
        <property name="attributeService" ref="attributeService"/>
        <property name="meterDao" ref="meterDao"/>
    </bean>
    
    <bean id="meterInformationWidget"
    	class="com.cannontech.web.widget.MeterInformationWidget">
    	<property name="title" value="Meter Information"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="meterDao" ref="meterDao"/>
        <property name="paoDefinitionDao" ref="paoDefinitionDao"/>
        <property name="commandRequestExecutor" ref="commandRequestDeviceExecutor"/>
    </bean>
    
    <bean id="simpleAttributesWidget"
        class="com.cannontech.web.widget.SimpleAttributesWidget">
        <property name="title" value="Voltage"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="attributeService" ref="attributeService" />
        <property name="plcDeviceAttributeReadService" ref="plcDeviceAttributeReadService" />
        <property name="meterDao" ref="meterDao"/>
        <property name="deviceDao" ref="deviceDao"/>
    </bean>
    
    <bean id="touScheduleWidget"
        class="com.cannontech.web.widget.TouScheduleWidget">
        <property name="title" value="TOU Schedule"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="meterDao" ref="meterDao"/>
        <property name="commandRequestExecutor" ref="commandRequestDeviceExecutor"/>
        <property name="databaseCache" ref="databaseCache"/>
    </bean>
    
    <bean id="meterReadingsWidget"
    	class="com.cannontech.web.widget.MeterReadingsWidget">
    	<property name="title" value="Meter Readings"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
              <bean class="com.cannontech.web.widget.support.SimpleWidgetInput">
                  <property name="name" value="startOffset"/>
                  <property name="description" value="the number of prior day's of point history to display"/>
                  <property name="required" value="false"/>
              </bean>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="attributesToShow">
          <list>
            <value>USAGE</value>
            <value>PEAK_DEMAND</value>
            <value>DEMAND</value>
            <value>VOLTAGE</value>
          </list>
        </property>
    </bean>
    
    <bean id="rfnMeterInfoWidget" class="com.cannontech.web.widget.RfnMeterInfoWidget">
    	<property name="title" value="RFN Meter Info"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
    </bean>
    
    <bean id="miniTdcWidget"
    	class="com.cannontech.web.widget.MiniTdcWidget">
    	<property name="title" value="Mini TDC"/>
        <property name="identityPath" value="miniTdcWidget/identity.jsp" />
        <property name="inputs">
           <set>
                <bean class="com.cannontech.web.widget.support.SimpleWidgetInput">
                    <property name="name" value="displayNumber"/>
                    <property name="description" value="the number of a TDC display"/>
                    <property name="required" value="true"/>
                </bean>
           </set>
        </property>
        <property name="jdbcTemplate" ref="simpleJdbcTemplate"/>
        <property name="pointDao" ref="pointDao"/>
        <property name="paoDao" ref="paoDao"/>
    </bean>
    
    <bean id="profileWidget"
    	class="com.cannontech.web.widget.ProfileWidget">
    	<property name="title" value="Profile Collection"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="loadProfileService" ref="loadProfileService" />
        <property name="emailService" ref="emailService"/>
        <property name="paoDao" ref="paoDao"/>
        <property name="deviceDao" ref="deviceDao"/>
        <property name="meterDao" ref="meterDao"/>
        <property name="dateFormattingService" ref="dateFormattingService"/>
        <property name="deviceErrorTranslatorDao" ref="deviceErrorTranslator"/>
        <property name="attributeService" ref="attributeService"/>
        <property name="yukonUserDao" ref="yukonUserDao"/>
        <property name="contactDao" ref="contactDao"/>
        <property name="simpleReportService" ref="simpleReportService"/>
        <property name="toggleProfilingService" ref="toggleProfilingService"/>
        
    </bean>
    
    <bean id="pendingProfilesWidget"
     class="com.cannontech.web.widget.PendingProfilesWidget">
     <property name="title" value="Pending Profile Collections"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="loadProfileService" ref="loadProfileService" />
        <property name="paoDao" ref="paoDao"/>
        
    </bean>
    
    <bean id="userPermissionEditorWidget"
    	class="com.cannontech.web.widget.UserPermissionEditorWidget">
    	<property name="title" value="User Permission Editor"/>
        <property name="identityPath" value="common/userPermissionIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.constraint"/>
              <ref local="widgetInput.permission"/>
              <ref local="widgetInput.permissionAllow"/>
              <ref local="widgetInput.userId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="ADMIN_LM_USER_ASSIGN"/>
            </bean>
	   	</property>
        <property name="yukonUserDao" ref="yukonUserDao"/>
        <property name="paoDao" ref="paoDao"/>
        <property name="paoGroups" ref="paoGroupsWrapper"/>
        <property name="editorService" ref="userEditorService"/>
    </bean>
    
    <bean id="groupPermissionEditorWidget"
    	class="com.cannontech.web.widget.GroupPermissionEditorWidget">
    	<property name="title" value="Group Permission Editor"/>
        <property name="identityPath" value="common/groupPermissionIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.constraint"/>
              <ref local="widgetInput.permission"/>
              <ref local="widgetInput.permissionAllow"/>
              <ref local="widgetInput.groupId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="ADMIN_LM_USER_ASSIGN"/>
            </bean>
	   	</property>
        <property name="yukonGroupDao" ref="yukonGroupDao"/>
        <property name="paoDao" ref="paoDao"/>
        <property name="paoGroups" ref="paoGroupsWrapper"/>
        <property name="editorService" ref="groupEditorService"/>
    </bean>

    <bean id="peakReportWidget"
    	class="com.cannontech.web.widget.PeakReportWidget">
    	<property name="title" value="Peak Summary Report"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="METERING"/>
            </bean>
	   	</property>
        <property name="peakReportService" ref="peakReportService" />
        <property name="meterDao" ref="meterDao"/>
        <property name="dateFormattingService" ref="dateFormattingService"/>
        <property name="attributeService" ref="attributeService"/>
        <property name="commandAuthorizationService" ref="paoCommandAuthorizationService" />
    </bean>
    
    <bean id="outageMonitorsWidget" class="com.cannontech.web.widget.OutageMonitorsWidget">
    	<property name="title" value="Outage Monitors"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="OUTAGE_PROCESSING"/>
            </bean>
	   	</property>
    </bean>
    
    <bean id="tamperFlagMonitorsWidget" class="com.cannontech.web.widget.TamperFlagMonitorsWidget">
    	<property name="title" value="Tamper Flag Monitors"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="TAMPER_FLAG_PROCESSING"/>
            </bean>
	   	</property>
    </bean>
    
    <bean id="statusPointMonitorsWidget" class="com.cannontech.web.widget.StatusPointMonitorsWidget">
        <property name="title" value="Status Point Monitors"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="STATUS_POINT_MONITORING"/>
            </bean>
        </property>
    </bean>
    
    <bean id="porterResponseMonitorsWidget" class="com.cannontech.web.widget.PorterResponseMonitorsWidget">
        <property name="title" value="Porter Response Monitor"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="PORTER_RESPONSE_MONITORING"/>
            </bean>
        </property>
    </bean>

    <bean id="validationMonitorsWidget" class="com.cannontech.web.widget.ValidationMonitorsWidget">
        <property name="title" value="Validation Monitors"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="VALIDATION_ENGINE"/>
            </bean>
        </property>
    </bean>
    
    <bean id="deviceReconfigMonitorsWidget" class="com.cannontech.web.widget.DeviceReconfigMonitorsWidget">
        <property name="title" value="Inventory Configuration Tasks"/>
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="DEVICE_RECONFIG"/>
            </bean>
        </property>
    </bean>
    
    <bean id="commandScheduleWidget" class="com.cannontech.web.widget.CommandScheduleWidget">
        <property name="title" value="Command Scheduling"/>
        <property name="roleAndPropertiesChecker">
            <bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="DEVICE_RECONFIG"/>
            </bean>
        </property>
    </bean>
    
    <bean id="scheduledGroupRequstExecutionWidget" class="com.cannontech.web.widget.ScheduledGroupRequstExecutionWidget">
    	<property name="title" value="Scheduled Requests"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
    </bean>
    
    <bean id="systemActionsMenuWidget" class="com.cannontech.web.widget.SystemActionsMenuWidget">
        <property name="title" value="Actions"/>
    </bean>
    
    <bean id="operatorAccountSearchWidget" class="com.cannontech.web.widget.OperatorAccountSearchWidget">
    	<property name="title" value="Account Search"/>
        <property name="roleAndPropertiesChecker">
	   		<bean factory-bean="roleAndPropertyDescriptionService" factory-method="compile">
                <constructor-arg value="CONSUMER_INFO"/>
            </bean>
	   	</property>
	   	<property name="inputs">
           <set>
              <ref local="widgetInput.operatorAccountSearchSearchBy"/>
              <ref local="widgetInput.operatorAccountSearchSearchValue"/>
           </set>
        </property>
    </bean>
    
    <!-- Update Service -->
    <bean id="dataUpdaterService" class="com.cannontech.web.updater.DefaultDataUpdaterService"
        abstract="false" lazy-init="default" autowire="default">
        <property name="timeSource">
            <ref bean="timeSource" />
        </property>
        <property name="backs">
            <map>
                <entry key="POINT">
                    <ref local="pointUpdateBackingService" />
                </entry>
                <entry key="ALERT">
                    <ref local="alertUpdateBackingService" />
                </entry>
                <entry key="CBCAREA">
                    <ref local="cbcAreaUpdateBackingService" />
                </entry>
                <entry key="CBCSPECIALAREA">
                    <ref local="cbcSpecialAreaUpdateBackingService" />
                </entry>
                <entry key="SUBSTATION">
                    <ref local="subStationUpdateBackingService"/>
                </entry>
                <entry key="SUBBUS">
                    <ref local="subBusUpdateBackingService"/>
                </entry>
                <entry key="FEEDER">
                    <ref local="feederUpdateBackingService"/>
                </entry>
                <entry key="CAPBANK">
                    <ref local="capBankUpdateBackingService"/>
                </entry>
                <entry key="BACKGROUNDPROCESS">
                    <ref local="backgroundProcessBackingService"/>
                </entry>
                <entry key="ROUTELOCATE">
                    <ref local="routeLocateBackingService"/>
                </entry>
                <entry key="COMMANDER">
                    <ref local="commanderUpdateBackingService"/>
                </entry>
                <entry key="COMMAND_REQUEST_EXECUTION">
                    <ref local="commandRequestExecutionBackingService"/>
                </entry>
                <entry key="SCHEDULED_GROUP_REQUEST_EXECUTION">
                    <ref local="scheduledGroupRequestExecutionBackingService"/>
                </entry>
                <entry key="OUTAGE_PROCESSING">
                    <ref local="outageMonitorBackingService"/>
                </entry>
                <entry key="TAMPER_FLAG_PROCESSING">
                    <ref local="tamperFlagMonitorBackingService"/>
                </entry>
                <entry key="STATUS_POINT_MONITORING">
                    <ref local="statusPointMonitorBackingService"/>
                </entry>
                <entry key="VALIDATION_PROCESSING">
                    <ref local="validationMonitorBackingService"/>
                </entry>
                <entry key="JOB">
                    <ref local="jobBackingService"/>
                </entry>
                <entry key="GROUP_METER_READ">
                    <ref local="groupMeterReadUpdateBackingService"/>
                </entry>
                <entry key="DR_CONTROLAREA">
                    <ref local="drControlAreaBackingService"/>
                </entry>
                <entry key="DR_CA_TRIGGER">
                    <ref local="drTriggerBackingService"/>
                </entry>              
                <entry key="DR_PROGRAM">
                    <ref local="drProgramBackingService"/>
                </entry>
                <entry key="DR_LOADGROUP">
                    <ref local="drLoadGroupBackingService"/>
                </entry>
                <entry key="DR_SCENARIO">
                    <ref local="drScenarioBackingService"/>
                </entry>
                <entry key="PHASE_DETECT">
                    <ref local="phaseDetectBackingService"/>
                </entry>    
                <entry key="DATABASE_MIGRATION">
                    <ref local="databaseMigrationBackingService"/>
                </entry>                
                <entry key="VOLTAGE_REGULATOR">
                    <ref local="voltageRegulatorBackingService"/>
                </entry>
                <entry key="MSP_DEVICE_GROUP_SYNC">
                    <ref local="multispeakDeviceGroupSyncBackingService"/>
                </entry> 
                <entry key="ACCOUNT_IMPORT">
                    <ref local="accountImportBackingService"/>
                </entry>
                <entry key="CAPCONTROL">
                    <ref local="capControlBackingService"/>
                </entry>
                <entry key="DEVICE_RECONFIG">
                    <ref local="deviceReconfigMonitorBackingService"/>
                </entry>
            </map>
        </property>
    </bean>
    
    <bean id="pointFormattingServiceForRequest" factory-bean="pointFormattingService"
        factory-method="getCachedInstance" scope="request">
        <aop:scoped-proxy proxy-target-class="false"/>
    </bean>
    
    <bean id="pointUpdateBackingService"
        class="com.cannontech.web.updater.point.PointUpdateBackingService">
        <property name="maxCacheSize">
            <value type="int">1000</value>
        </property>
        <property name="asyncDataSource">
            <ref bean="asyncDynamicDataSource" />
        </property>
        <property name="pointFormattingService">
            <ref bean="pointFormattingServiceForRequest" />
        </property>
        <property name="timeSource">
            <ref bean="timeSource" />
        </property>
        <property name="maxOverSize">
            <value type="int">100</value>
        </property>
    </bean>
    
    <bean id="pointDataUpdateRegistrationService"
        class="com.cannontech.web.updater.point.PointDataRegistrationServiceImpl" abstract="false">
        <property name="updaterService">
            <ref local="dataUpdaterService" />
        </property>
    </bean>
    
    <bean id="alertUpdateBackingService" class="com.cannontech.web.updater.alert.AlertUpdateBackingService">
        <property name="alertService" ref="alertService"/>
    </bean>
    
    <bean id="cbcAreaUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="cbcCache"/>
        <property name="formattingService" ref="cbcAreaFormattingService"/>        
    </bean>
    
    <bean id="cbcSpecialAreaUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="cbcCache"/>
        <property name="formattingService" ref="cbcSpecialAreaFormattingService"/>        
    </bean>
    
    <bean id="subStationUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="cbcCache"/>
        <property name="formattingService" ref="subStationFormattingService"/>        
    </bean>
    
    <bean id="subBusUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="capControlCache"/>
        <property name="formattingService" ref="subBusFormattingService"/>
    </bean>
    
    <bean id="feederUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="capControlCache"/>
        <property name="formattingService" ref="feederFormattingService"/>    
    </bean>
    
    <bean id="capBankUpdateBackingService" class="com.cannontech.web.updater.capcontrol.CapControlUpdateBackingService">
        <property name="capControlCache" ref="capControlCache"/>
        <property name="formattingService" ref="capBankFormattingService"/>
    </bean>
    
    <bean id="routeLocateBackingService" class="com.cannontech.web.updater.routeLocate.RouteLocateBackingService">
        <property name="objectFormattingService" ref="objectFormattingService" />
        <property name="resultsCache" ref="routeLocateResultsCache" />
    </bean>
    
    <bean id="commanderUpdateBackingService" class="com.cannontech.web.updater.commander.GroupCommandResultBackingService">
        <property name="objectFormattingService" ref="objectFormattingService" />
        <property name="groupCommandExecutor" ref="groupCommandExecutor" />
    </bean>
    
    <bean id="backgroundProcessBackingService" class="com.cannontech.web.updater.bulk.BackgroundProcessBackingService">
        <property name="objectFormattingService" ref="objectFormattingService" />
        <property name="recentResultsCache" ref="recentResultsCache" />
    </bean>
    
    <bean id="groupMeterReadUpdateBackingService" class="com.cannontech.web.updater.groupMeterRead.GroupMeterReadUpdateBackingService">
        <property name="objectFormattingService" ref="objectFormattingService" />
    </bean>
    
    <bean id="commandRequestExecutionBackingService" class="com.cannontech.web.updater.commandRequestExecution.CommandRequestExecutionBackingService"/>
    <bean id="requestCountCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.RequestCountCommandExecutionUpdaterHandler"/>
    <bean id="resultsCountCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.ResultsCountCommandExecutionUpdaterHandler"/>
    <bean id="successResultsCountCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.SuccessResultsCountCommandExecutionUpdaterHandler"/>
    <bean id="failureResultsCountCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.FailureResultsCountCommandExecutionUpdaterHandler"/>
    <bean id="stopTimeCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.StopTimeCommandExecutionUpdaterHandler"/>
    <bean id="isCompleteCommandExecutionUpdaterHandler" class="com.cannontech.web.updater.commandRequestExecution.handler.IsCompleteCommandExecutionUpdaterHandler"/>
    
    <bean id="scheduledGroupRequestExecutionBackingService" class="com.cannontech.web.updater.scheduledGroupRequestExecution.ScheduledGroupRequestExecutionBackingService"/>
    <bean id="lastRunDateForJobScheduledGroupRequestExecutionUpdaterHandler" class="com.cannontech.web.updater.scheduledGroupRequestExecution.handler.LastRunDateForJobScheduledGroupRequestExecutionUpdaterHandler"/>
    <bean id="lastRequestCountForJobScheduledGroupRequestExecutionUpdaterHandler" class="com.cannontech.web.updater.scheduledGroupRequestExecution.handler.LastRequestCountForJobScheduledGroupRequestExecutionUpdaterHandler"/>
    <bean id="lastSuccessResultsCountForJobScheduledGroupRequestExecutionUpdaterHandler" class="com.cannontech.web.updater.scheduledGroupRequestExecution.handler.LastSuccessResultsCountForJobScheduledGroupRequestExecutionUpdaterHandler"/>
    <bean id="lastFailureResultsCountForJobScheduledGroupRequestExecutionUpdaterHandler" class="com.cannontech.web.updater.scheduledGroupRequestExecution.handler.LastFailureResultsCountForJobScheduledGroupRequestExecutionUpdaterHandler"/>
    <bean id="creCountForJobLastCreIdForJobScheduledGroupRequestExecutionUpdaterHandler" class="com.cannontech.web.updater.scheduledGroupRequestExecution.handler.CreCountForJobLastCreIdForJobScheduledGroupRequestExecutionUpdaterHandler"/>
    
    <!-- outage -->
    <bean id="outageMonitorBackingService" class="com.cannontech.web.updater.outageProcessing.OutageMonitorBackingService">
    </bean>
    <bean id="violationsCountOutageProcessingUpdaterHandler" class="com.cannontech.web.updater.outageProcessing.handler.ViolationsCountOutageProcessingUpdaterHandler"/>
    <bean id="monitoringCountOutageProcessingUpdaterHandler" class="com.cannontech.web.updater.outageProcessing.handler.MonitoringCountOutageProcessingUpdaterHandler"/>
    
    <!-- tamper -->
    <bean id="tamperFlagMonitorBackingService" class="com.cannontech.web.updater.tamperFlagProcessing.TamperFlagMonitorBackingService">
    </bean>
    <bean id="violationsCountTamperFlagProcessingUpdaterHandler" class="com.cannontech.web.updater.tamperFlagProcessing.handler.ViolationsCountTamperFlagProcessingUpdaterHandler"/>
    <bean id="monitoringCountTamperFlagProcessingUpdaterHandler" class="com.cannontech.web.updater.tamperFlagProcessing.handler.MonitoringCountTamperFlagProcessingUpdaterHandler"/>
    
    <!-- status point -->
    <bean id="statusPointMonitorBackingService" class="com.cannontech.web.updater.statusPointMonitoring.StatusPointMonitorBackingService">
    </bean>
    <bean id="monitoringCountStatusPointProcessingUpdaterHandler" class="com.cannontech.web.updater.statusPointMonitoring.handler.MonitoringCountStatusPointProcessingUpdaterHandler"/>
    
    <!-- validation -->
    <bean id="validationMonitorBackingService" class="com.cannontech.web.updater.validationProcessing.ValidationMonitorBackingService">
    </bean>
    <bean id="monitoringCountValidationProcessingUpdaterHandler" class="com.cannontech.web.updater.validationProcessing.handler.MonitoringCountValidationProcessingUpdaterHandler"/>
    
    <!-- jobs -->
    <bean id="jobBackingService" class="com.cannontech.web.updater.job.JobBackingService">
    </bean>
    <bean id="lastRunJobUpdaterHandler" class="com.cannontech.web.updater.job.handler.LastRunJobUpdaterHandler"/>
    <bean id="nextRunJobUpdaterHandler" class="com.cannontech.web.updater.job.handler.NextRunJobUpdaterHandler"/>
    <bean id="scheduleDescriptionJobUpdaterHandler" class="com.cannontech.web.updater.job.handler.ScheduleDescriptionJobUpdaterHandler"/>
    <bean id="stateJobUpdaterHandler" class="com.cannontech.web.updater.job.handler.StateJobUpdaterHandler"/>
    <bean id="stateTextJobUpdaterHandler" class="com.cannontech.web.updater.job.handler.StateTextJobUpdaterHandler"/>

    <bean id="drControlAreaBackingService" class="com.cannontech.web.updater.dr.ControlAreaBackingService"/>
    <bean id="drTriggerBackingService" class="com.cannontech.web.updater.dr.TriggerBackingService"/>    
    <bean id="drProgramBackingService" class="com.cannontech.web.updater.dr.ProgramBackingService"/>
    <bean id="drLoadGroupBackingService" class="com.cannontech.web.updater.dr.LoadGroupBackingService"/>
    <bean id="drScenarioBackingService" class="com.cannontech.web.updater.dr.ScenarioBackingService"/>
    
    <!-- phase detect -->    
    <bean id="phaseDetectBackingService" class="com.cannontech.web.updater.phaseDetect.PhaseDetectBackingService"/>
    <bean id="isCompletePhaseDetectUpdaterHandler" class="com.cannontech.web.updater.phaseDetect.handler.IsCompletePhaseDetectUpdaterHandler"/>
    <bean id="resultsCountPhaseDetectUpdaterHandler" class="com.cannontech.web.updater.phaseDetect.handler.ResultsCountPhaseDetectUpdaterHandler"/>
    
    <!-- database migration -->
    <bean id="databaseMigrationBackingService" class="com.cannontech.web.updater.databaseMigration.DatabaseMigrationBackingService"/>
    
    <bean id="abstractFormattingService" class="com.cannontech.web.updater.capcontrol.AbstractFormattingService"
          abstract="true">
        <property name="filterCacheFactory" ref="filterCacheFactory"/>
    </bean>
    
    <bean id="abstractAreaFormattingService" class="com.cannontech.web.updater.capcontrol.AbstractAreaFormatingService"
          parent="abstractFormattingService" abstract="true">
    </bean>
    
    <bean id="capControlBackingService" class="com.cannontech.web.updater.capcontrol.CapControlBackingService"/>
    <bean id="capControlSystemEnableCommandHandler" class="com.cannontech.web.updater.capcontrol.handler.CapControlSystemEnableCommandHandler"/>
    
    <bean id="voltageRegulatorBackingService" class="com.cannontech.web.updater.capcontrol.VoltageRegulatorBackingService"/>
    <bean id="voltageRegulatorModeUpdaterHandler" class="com.cannontech.web.updater.capcontrol.handler.VoltageRegulatorModeUpdaterHandler"/>
	<bean id="voltageRegulatorTapHandler" class="com.cannontech.web.updater.capcontrol.handler.VoltageRegulatorTapHandler"/>
	<bean id="voltageRegulatorOpTimeHandler" class="com.cannontech.web.updater.capcontrol.handler.VoltageRegulatorOpTimeHandler"/>
	
    <bean id="cbcAreaFormattingService" class="com.cannontech.web.updater.capcontrol.CBCAreaFormattingService"
          parent="abstractAreaFormattingService"/>
    
    <bean id="cbcSpecialAreaFormattingService" class="com.cannontech.web.updater.capcontrol.CBCSpecialAreaFormattingService"
          parent="abstractAreaFormattingService"/>
    
    <bean id="subStationFormattingService" class="com.cannontech.web.updater.capcontrol.SubStationFormattingService"
          parent="abstractAreaFormattingService"/>
    
    <bean id="subBusFormattingService" class="com.cannontech.web.updater.capcontrol.SubBusFormattingService"
          parent="abstractFormattingService"/>
    
    <bean id="feederFormattingService" class="com.cannontech.web.updater.capcontrol.FeederFormattingService"
          parent="abstractFormattingService"/>
    
    <bean id="capBankFormattingService" class="com.cannontech.web.updater.capcontrol.CapBankFormattingService"
          parent="abstractFormattingService"/>
    
    <bean id="capControlValueTagPrototype" class="com.cannontech.web.updater.capcontrol.CapControlValueTag">
        <property name="updaterService" ref="dataUpdaterService" />
    </bean>
    
    <bean id="navigableHierarchyTagPrototype" class="com.cannontech.web.capcontrol.NavigableHierarchyTag"/>
    
    <bean id="paoDetailUrlTagPrototype" class="com.cannontech.web.taglib.PaoDetailUrlTag">
        <property name="paoDetailUrlHelper" ref="paoDetailUrlHelper"/>
    </bean>
    
    <bean id="formatTemplateTagPrototype" class="com.cannontech.web.i18n.FormatTemplateTag">
        <property name="templateProcessorFactory" ref="templateProcessorFactory" />
        <property name="messageSourceResolver" ref="yukonUserContextMessageSourceResolver" />
    </bean>
    
    <bean id="dataUpdaterValueTagPrototype" class="com.cannontech.web.taglib.DataUpdaterValueTag">
        <property name="dataUpdaterService" ref="dataUpdaterService"/>
    </bean>
    
    <bean id="classUpdaterTagPrototype" class="com.cannontech.web.taglib.ClassUpdaterTag">
        <property name="dataUpdaterService" ref="dataUpdaterService"/>
    </bean>

    <bean id="pointValueTagPrototype" class="com.cannontech.web.updater.point.PointValueTag">
        <property name="registrationService" ref="pointDataUpdateRegistrationService"/>
    </bean>

    <bean id="deviceNameTagPrototype" class="com.cannontech.web.amr.taglib.DeviceNameTag">
        <property name="deviceDao" ref="deviceDao"/>
    </bean>
    
    <bean id="dataUpdaterCallbackTagPrototype" class="com.cannontech.web.updater.DataUpdaterCallbackTag">
        <property name="registrationService" ref="dataUpdaterService"/>
    </bean>
    
    <bean id="dataUpdaterEventCallbackTagPrototype" class="com.cannontech.web.updater.DataUpdaterEventCallbackTag"/>

    <bean id="pointValueFormatterTagPrototype" class="com.cannontech.web.taglib.PointValueFormatterTag">
        <property name="pointFormattingService" ref="pointFormattingServiceForRequest"/>
    </bean>
    
    <bean id="simpleReportLinkFromNameTagPrototype" class="com.cannontech.web.reports.SimpleReportLinkFromNameTag">
        <property name="reportDefinitionFactory" ref="yukonReportModelDefinitionFactory"/>
        <property name="simpleReportService" ref="simpleReportService"/>
    </bean>
    
    <bean id="simpleReportUrlFromNameTagPrototype" class="com.cannontech.web.reports.SimpleReportUrlFromNameTag">
        <property name="reportDefinitionFactory" ref="yukonReportModelDefinitionFactory"/>
        <property name="simpleReportService" ref="simpleReportService"/>
    </bean>
    
    <bean id="simpleReportLinkFromModelTagPrototype" class="com.cannontech.web.reports.SimpleReportLinkFromModelTag">
        <property name="reportDefinitionFactory" ref="yukonReportModelDefinitionFactory"/>
    </bean>
    
    <bean id="deviceGroupHierarchyJsonPrototype" class="com.cannontech.web.taglib.DeviceGroupHierarchyJsonTag">
        <property name="deviceGroupService" ref="deviceGroupService"/>
        <property name="deviceGroupUiService" ref="deviceGroupUiService"/>
    </bean>
    
    <bean id="verifyRolesAndPropertiesTagPrototype" class="com.cannontech.web.util.VerifyRolesAndPropertiesTag">
        <property name="descriptionService" ref="roleAndPropertyDescriptionService"/>
    </bean>
    
    <bean id="verifyRolePropertyValueTagPrototype" class="com.cannontech.web.util.VerifyRolePropertyValueTag">
    	<property name="rolePropertyDao" ref="rolePropertyDao"/>
    </bean>
    
    <bean id="verifyGlobalRolesAndPropertiesTagPrototype" class="com.cannontech.web.util.VerifyGlobalRolesAndPropertiesTag">
        <property name="descriptionService" ref="roleAndPropertyDescriptionService"/>
    </bean>
    
    <bean id="checkGlobalRolesAndPropertiesTagPrototype" class="com.cannontech.web.taglib.CheckGlobalRolesAndPropertiesTag">
        <property name="descriptionService" ref="roleAndPropertyDescriptionService"/>
    </bean>
    
    <bean id="checkPaoAuthorizationTagPrototype" class="com.cannontech.web.taglib.CheckPaoAuthorizationTag">
        <property name="paoAuthorizationService" ref="paoAuthorizationService"/>
    </bean>
    
    <bean id="msg2TagPrototype" class="com.cannontech.web.i18n.Msg2Tag">
        <property name="objectFormattingService" ref="objectFormattingService"/>
    </bean>
    
    <bean id="getCsrfTokenTagPrototype" class="com.cannontech.web.taglib.GetCsrfTokenTag">
        <property name="tokenService" ref="csrfTokenService"/>
    </bean>
    
    <bean id="csrfTokenService" class="com.cannontech.web.security.csrf.CsrfTokenService"/>
    
    <bean id="trendWidgetCachingParameterGrabber" abstract="true">
        <property name="maxCacheSize" value="50" />
        <property name="accessOrder" value="true" />
    </bean>
    
    <bean id="csrTrendWidgetCachingWidgetParameterGrabber" parent="trendWidgetCachingParameterGrabber" class="com.cannontech.web.widget.support.impl.CachingWidgetParameterGrabber" scope="session">
        <property name="useCache" value="true" />
        <property name="uniqueIdentifiers">
            <list>
                <value>csrTrendWidget</value>
            </list>
        </property>
        <aop:scoped-proxy/>
    </bean>
    
    <bean id="hbcTrendWidgetCachingWidgetParameterGrabber" parent="trendWidgetCachingParameterGrabber" class="com.cannontech.web.widget.support.impl.CachingWidgetParameterGrabber" scope="session">
        <property name="useCache" value="false" />
        <aop:scoped-proxy/>
    </bean>

    <bean id="trendWidget" abstract="true">
    	<property name="title" value="Trend"/>
        <property name="identityPath" value="common/deviceIdentity.jsp" />
        <property name="inputs">
           <set>
              <ref local="widgetInput.deviceId"/>
           </set>
        </property>
        <property name="deviceDao" ref="deviceDao" />
        <property name="attributeService" ref="attributeService" />
        <property name="dateFormattingService" ref="dateFormattingService" />
        <property name="supportedAttributeGraphSet">
			<list>
				<bean class="com.cannontech.common.chart.model.AttributeGraphType">
					<property name="attribute" value="LOAD_PROFILE"/>
					<property name="graphType" value="LINE"/>
					<property name="converterType" value="RAW"/>
					<property name="label" value="Load Profile"/>
					<property name="description">
						<value>
							<![CDATA[Graph of raw Load Profile data.]]>
						</value>
					</property>
				</bean>
				<bean class="com.cannontech.common.chart.model.AttributeGraphType">
                      <property name="attribute" value="VOLTAGE_PROFILE"/>
                      <property name="graphType" value="LINE"/>
                      <property name="converterType" value="RAW"/>
                      <property name="label" value="Voltage Profile"/>
                      <property name="description">
                            <value>
                                  <![CDATA[Graph of raw Voltage Profile data.]]>
                            </value>
                      </property>
                </bean>
				<bean class="com.cannontech.common.chart.model.AttributeGraphType">
					<property name="attribute" value="DEMAND"/>
					<property name="graphType" value="LINE"/>
					<property name="converterType" value="RAW"/>
					<property name="label" value="Demand"/>
					<property name="description">
						<value>
							<![CDATA[Graph of raw Demand data.]]>
						</value>
					</property>
				</bean>
				<bean class="com.cannontech.common.chart.model.AttributeGraphType">
					<property name="attribute" value="USAGE"/>
					<property name="graphType" value="COLUMN"/>
					<property name="converterType" value="NORMALIZED_DELTA"/>
					<property name="label" value="Usage (Normalized)"/>
					<property name="description">
						<value>
							<![CDATA[The <b>Normalized Usage</b> graph is a normalized view of the usage data.<br><br>  Each
							point on the graph is generated using the following formula: (reading - 
							previousReading) / (days between readings)]]>
						</value>
					</property>
				</bean>
        	</list>
        </property>
    </bean>
 
    <bean id="csrTrendWidget" class="com.cannontech.web.widget.TrendWidget" parent="trendWidget">
        <property name="cachingWidgetParameterGrabber" ref="csrTrendWidgetCachingWidgetParameterGrabber" />
    </bean>
    
    <bean id="hbcTrendWidget" class="com.cannontech.web.widget.TrendWidget" parent="trendWidget">
        <property name="cachingWidgetParameterGrabber" ref="hbcTrendWidgetCachingWidgetParameterGrabber" />
    </bean> 

    <bean id="operationsSetupTagPrototype" class="com.cannontech.web.taglib.OperationsSetupTag"/>

    <bean id="attributeResolverTagPrototype" class="com.cannontech.web.taglib.AttributeResolverTag">
        <property name="deviceDao" ref="deviceDao" />
        <property name="attributeService" ref="attributeService"/>
    </bean>
    
    <bean id="formatDateTagPrototype" class="com.cannontech.web.taglib.FormatDateTag">
        <property name="dateFormattingService" ref="dateFormattingService"/>
    </bean>
    
    <bean id="formatPeriodTagPrototype" class="com.cannontech.web.taglib.FormatPeriodTag">
        <property name="durationFormattingService" ref="durationFormattingService"/>
    </bean>
    
    <bean id="formatNotificationTagPrototype" class="com.cannontech.web.taglib.FormatNotificationTag"/>

    <bean id="formatMillisTagPrototype" class="com.cannontech.web.taglib.FormatMillisTag">
        <property name="dateFormattingService" ref="dateFormattingService"/>
    </bean>
    
    <bean id="formatDurationTagPrototype" class="com.cannontech.web.taglib.FormatDurationTag"/>
    
    <bean id="formatCronTagPrototype" class="com.cannontech.web.taglib.FormatCronTag"/>
    
    <bean id="formatObjectTagPrototype" class="com.cannontech.web.taglib.FormatObjectTag"/>

    <bean id="formatTimePeriodTagPrototype" class="com.cannontech.web.taglib.FormatTimePeriodTag"/>
    
    <bean id="pointStatusColorTagPrototype" class="com.cannontech.web.taglib.PointStatusColorTag">
        <property name="pointDataRegistrationService" ref="pointDataUpdateRegistrationService"/>
    </bean>
    
    <bean id="capBankStateColorTagPrototype" class="com.cannontech.web.taglib.CapBankStateColorTag">
        <property name="updaterService" ref="dataUpdaterService" />
    </bean>
    
    <bean id="customerAccountInfoTagPrototype" class="com.cannontech.web.stars.dr.taglib.CustomerAccountInfoTag">
        <property name="customerDao" ref="customerDao"/>
        <property name="accountSiteDao" ref="accountSiteDao"/>
        <property name="addressDao" ref="addressDao"/>
        <property name="messageSourceResolver" ref="yukonUserContextMessageSourceResolver"/>
        <property name="phoneNumberFormattingService" ref="phoneNumberFormattingService"/>
    </bean>     
    
    <bean id="userNameTagPrototype" class="com.cannontech.web.taglib.UserNameTag">
        <property name="yukonUserDao" ref="yukonUserDao"/>
    </bean>
    
    <bean id="yukonListEntryListTagPrototype" class="com.cannontech.web.taglib.YukonListEntryListTag">
	    <property name="starsDatabaseCache" ref="starsDatabaseCache"/>
	</bean>

    <bean id="yukonListEntryValueTagPrototype" class="com.cannontech.web.taglib.YukonListEntryValueTag">
    	<property name="yukonListDao" ref="yukonListDao"/>
    </bean>
    
    <!-- Remember to add friendlyExceptionPropertyKey key to friendlyException.properties file -->
    <bean id="friendlyExceptionResolver" class="com.cannontech.common.util.FriendlyExceptionResolver">
        
        <property name="exceptionStrings" ref="friendlyExceptionsProperties" />
        
        <property name="knownExceptions">
            <list>
                 <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.message.util.ConnectionException" />
                    <property name="friendlyExceptionPropertyKey" value="ConnectionException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                	<property name="exceptionClass" value="com.cannontech.core.dynamic.exception.DynamicDataAccessException" />
                	<property name="friendlyExceptionPropertyKey" value="DispatchInvalid" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.exception.InitiateLoadProfileRequestException" />
                    <property name="friendlyExceptionPropertyKey" value="LoadProfileException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.exception.PingMeterException" />
                    <property name="friendlyExceptionPropertyKey" value="PingMeterException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.exception.PeakSummaryReportRequestException" />
                    <property name="friendlyExceptionPropertyKey" value="PeakReportException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.exception.MeterReadRequestException" />
                    <property name="friendlyExceptionPropertyKey" value="MeterReadException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.exception.NotAuthorizedException" />
                    <property name="friendlyExceptionPropertyKey" value="NotAuthorizedException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.device.groups.TemporaryDeviceGroupNotFoundException" />
                    <property name="friendlyExceptionPropertyKey" value="TemporaryDeviceGroupNotFoundException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.common.util.ResultResultExpiredException" />
                    <property name="friendlyExceptionPropertyKey" value="ResultResultExpiredException" />
                </bean>
                <bean class="com.cannontech.common.util.KnownExceptionType">
                    <property name="exceptionClass" value="com.cannontech.web.bulk.model.DeviceCollectionCreationException" />
                    <property name="friendlyExceptionPropertyKey" value="DeviceCollectionCreationException" />
                    <property name="includeCauseMessage" value="true" />
                </bean>
            </list>
        </property>
    
    </bean>	
    
    <bean id="friendlyExceptionsProperties" class="org.springframework.beans.factory.config.PropertiesFactoryBean">
    	<property name="location">
    		<value>/WEB-INF/friendlyExceptions.properties</value>
    	</property>
    </bean>
    
    <bean id="urlAccessChecker" class="com.cannontech.web.login.access.UrlAccessCheckerImpl">
        <property name="descriptionParser">
            <bean class="com.cannontech.web.login.access.UrlAccessDescriptionParser"/>
        </property>
        <property name="urlAccessDescriptions">
            <list>
                <!-- DO NOT REMOVE -->
                <value>ALLOW|/remote/**|DATABASE_EDITOR,TABULAR_DISPLAY_CONSOLE,COMMANDER,APPLICATION_ESUBSTATION_EDITOR,TRENDING</value>
                <value>ALLOW|/|WEB_CLIENT</value>
                <value>ALLOW|/index.jsp|WEB_CLIENT</value>
                <value>ALLOW|/home|WEB_CLIENT</value>
                <value>DENY|/spring/debug/**|!ENABLE_WEB_DEBUG_PAGES</value>
                                                
                <value>ALLOW|/spring/stars/consumer/**|RESIDENTIAL_CUSTOMER</value>
                <value>ALLOW|/spring/login/changelogin/updateusername|RESIDENTIAL_CUSTOMER</value>
                <value>ALLOW|/spring/login/changelogin/updatepassword|RESIDENTIAL_CUSTOMER</value>                                
                <!-- Allow for Trending -->
                <value>ALLOW|/servlet/GraphGenerator|RESIDENTIAL_CUSTOMER</value>
                <value>ALLOW|/servlet/Download|RESIDENTIAL_CUSTOMER</value>
                <value>ALLOW|/include/trending_print.jsp|RESIDENTIAL_CUSTOMER</value>
                <value>ALLOW|/include/options_popup.jsp|RESIDENTIAL_CUSTOMER</value>
                               
                <value>DENY|/**|RESIDENTIAL_CUSTOMER</value>
                
                <!-- Deny Capacitor Control to all except CBCSettingsRole role -->
                <value>DENY|/spring/capcontrol/**|!CBC_SETTINGS</value>            
                <value>DENY|/capcontrol/**|!CBC_SETTINGS</value>
                
                <value>DENY|/spring/support/**|!OPERATOR_ADMINISTRATOR</value>
                
                <!-- Allow explicit access to each Admin page.  Default DENY to all pages unless ADMIN_EDIT_ENERGY_COMPANY -->
                <!-- These should be removed with the rewrite of Energy Company configuration pages. -->
                <!-- Authorization should be handled on the controller side (with the rewrite). -->
                <value>ALLOW|/operator/Admin/Address.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/ConfigEnergyCompany.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/EnergyCompany.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/ManageMembers.jsp|ADMIN_MANAGE_MEMBERS</value>
                <value>ALLOW|/operator/Admin/Message.jsp|WEB_CLIENT</value> <!-- Using WebClient to allow "full" access to  -->
                <value>ALLOW|/operator/Admin/NewCodes.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/NewEnergyCompany.jsp|ADMIN_CREATE_DELETE_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/OperatorLogin.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/Progress.jsp|WEB_CLIENT</value> <!-- Using WebClient to allow "full" access to  -->
                <value>ALLOW|/operator/Admin/Routes.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/SelectionList.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/ServiceCompany.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/SettlementConfig.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/Substation.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/SwitchCommands.jsp|ADMIN_VIEW_BATCH_COMMANDS</value>
                <value>ALLOW|/operator/Admin/ThermSchedule.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>ALLOW|/operator/Admin/Warehouse.jsp|ADMIN_EDIT_ENERGY_COMPANY</value>
                <value>DENY|/operator/Admin/**|*</value>
                
                
                <value>ALLOW|/**|WEB_CLIENT</value>
                <value>DENY|/**|*</value>
                <!-- DO NOT REMOVE -->
            </list>
        </property>    
    </bean>

    <bean id="loginService"
        class="com.cannontech.web.login.impl.LoginServiceImpl">
        <property name="authenticationService" ref="authenticationService"/>
        <property name="authDao" ref="authDao" />
        <property name="contactDao" ref="contactDao" />
        <property name="yukonUserDao" ref="yukonUserDao" />
        <property name="rolePropertyDao" ref="rolePropertyDao" />
        <property name="sessionInitializers">
            <list>
                <ref bean="starsSessionInitializer"/>   
            </list>
        </property>
    </bean>
    
    <bean id="loginRequestHandlers" class="java.util.LinkedList">
        <constructor-arg>
            <list>
                <!--  processed by insertion order -->
                <ref bean="cookieLoginRequestHandler"/>
                <ref bean="defaultParamLoginRequestHandler"/>
            </list>
        </constructor-arg>
    </bean>

    <bean id="abstractLoginRequestHandler" class="com.cannontech.web.login.AbstractLoginRequestHandler"
          abstract="true">
        <property name="loginService" ref="loginService"/>
        <property name="config" ref="configurationSource"/>
        <property name="yukonUserDao" ref="yukonUserDao"/>
    </bean>          
    
    <bean id="cookieLoginRequestHandler" class="com.cannontech.web.login.impl.CookieLoginRequestHandler"
          parent="abstractLoginRequestHandler">
        <property name="loginCookieHelper" ref="loginCookieHelper"/>
    </bean>
    
    <bean id="defaultParamLoginRequestHandler" class="com.cannontech.web.login.impl.DefaultParamLoginRequestHandler"
          parent="abstractLoginRequestHandler">
    </bean>

    <bean id="loginCookieHelper" class="com.cannontech.web.login.impl.LoginCookieHelperImpl">
        <property name="cryptoService" ref="cryptoService"/>    
    </bean>
    
    <bean id="starsSessionInitializer" class="com.cannontech.web.login.impl.StarsSessionInitializer">
        <property name="starsDatabaseCache" ref="starsDatabaseCache"/>
    </bean>
    
    <bean id="themostatMenuOption" class="com.cannontech.web.menu.option.producer.ThermostatMenuOptionProducer">
        <property name="inventoryDao" ref="inventoryDao" />
        <property name="customerAccountDao" ref="customerAccountDao" />
        <property name="rolePropertyDao" ref="rolePropertyDao"/>
    </bean>
    
    <bean id="faqMenuOption" class="com.cannontech.web.menu.option.producer.FaqMenuOptionProducer"/>
    
    <bean id="trendingMenuOption" class="com.cannontech.web.menu.option.producer.TrendingMenuOptionProducer">
        <property name="graphDao" ref="graphDao" />
    </bean>
    <bean id="optOutMenuOption" class="com.cannontech.web.menu.option.producer.OptOutMenuOptionProducer">
        <property name="optOutStatusService" ref="optOutStatusService" />
    </bean>
    <bean id="drOptOutMenuOption" class="com.cannontech.web.menu.option.producer.DemandResponseOptOutMenuOptionProducer"/>

    <bean id="deviceFilterCollectionProducer" class="com.cannontech.web.bulk.model.collection.DeviceFilterCollectionProducer"/>
    <bean id="deviceGroupCollectionProducer" class="com.cannontech.web.bulk.model.collection.DeviceGroupCollectionProducer"/>

    <bean id="deviceFileUploadCollectionProducer" class="com.cannontech.web.bulk.model.collection.DeviceFileUploadCollectionProducer" />
    
    <bean id="deviceCollectionFactory"
        class="com.cannontech.web.bulk.model.DeviceCollectionFactoryImpl">
        <property name="collectionProducerList">
            <list>
                <ref bean="deviceGroupCollectionProducer" />
                <bean class="com.cannontech.web.bulk.model.collection.DeviceAddressRangeCollectionProducer" />
                <bean class="com.cannontech.web.bulk.model.collection.DeviceIdListCollectionProducer" />
                <ref bean="deviceFileUploadCollectionProducer"/>
                <ref bean="deviceFilterCollectionProducer"/>
            </list>
        </property>
    </bean>

    <bean id="deviceCollectionDeviceGroupHelper" class="com.cannontech.web.group.DeviceCollectionDeviceGroupHelper">
        <property name="deviceGroupEditorDao" ref="deviceGroupEditorDao" />
        <property name="deviceGroupMemberEditorDao" ref="deviceGroupMemberEditorDao" />
    </bean>
    
    <bean id="memoryCollectionProducer" class="com.cannontech.web.stars.dr.operator.inventoryOperations.model.collection.MemoryCollectionProducer" />
    
    <bean id="inventoryCollectionFactory" class="com.cannontech.web.common.collection.InventoryCollectionFactoryImpl">
        <property name="collectionProducerList">
            <list>
                <bean class="com.cannontech.web.stars.dr.operator.inventoryOperations.model.collection.InventoryIdListCollectionProducer" />
                <bean class="com.cannontech.web.stars.dr.operator.inventoryOperations.model.collection.InventoryFileUploadCollectionProducer" />
                <ref bean="memoryCollectionProducer"/>
            </list>
        </property>
    </bean>
    
    <bean id="inventoryOperationsFilterService" class="com.cannontech.web.stars.dr.operator.inventoryOperations.service.impl.InventoryOperationsFilterServiceImpl"/>
    
    <!-- Simple HTTP Post Service Factory -->
    <bean id="simpleHttpPostServiceFactory" class="com.cannontech.web.simplePost.impl.SimpleHttpPostServiceFactoryImpl">
    </bean>
    
    <!-- Cayenta API Service -->
    <bean id="cayentaApiService" class="com.cannontech.web.cayenta.service.impl.CayentaApiServiceImpl">
    </bean>
    
    <bean id="paoDetailUrlHelper" class="com.cannontech.web.common.pao.PaoDetailUrlHelper"/>
    
    <bean id="scheduledGroupRequestExecutionJobWrapperFactory" class="com.cannontech.web.common.scheduledGroupRequestExecution.ScheduledGroupRequestExecutionJobWrapperFactory"/>
    <bean id="commandRequestExecutionWrapperFactory" class="com.cannontech.web.common.commandRequestExecution.CommandRequestExecutionWrapperFactory"/>
    
    <!-- Cron tag handlers -->
    <bean id="cronExpressionTagService" class="com.cannontech.web.amr.util.cronExpressionTag.CronExpressionTagServiceImpl"/>
    
    <bean id="dailyCronTagStyleHandler" class="com.cannontech.web.amr.util.cronExpressionTag.handler.DailyCronTagStyleHandler"/>
    <bean id="monthlyCronTagStyleHandler" class="com.cannontech.web.amr.util.cronExpressionTag.handler.MonthlyCronTagStyleHandler"/>
    <bean id="oneTimeCronTagStyleHandler" class="com.cannontech.web.amr.util.cronExpressionTag.handler.OneTimeCronTagStyleHandler"/>
    <bean id="weeklyCronTagStyleHandler" class="com.cannontech.web.amr.util.cronExpressionTag.handler.WeeklyCronTagStyleHandler"/>
    <bean id="customCronTagStyleHandler" class="com.cannontech.web.amr.util.cronExpressionTag.handler.CustomCronTagStyleHandler"/>
    
    <bean id="attributeSelectorHelperService" class="com.cannontech.web.util.AttributeSelectorHelperServiceImpl"/>
    
    <!-- MULTISPEAK -->
    <bean id="mspMeterSearchService" class="com.cannontech.web.amr.meter.service.impl.MspMeterSearchServiceImpl"/>
    
    <bean id="serviceLocationMspMeterSearchMethodResultProvider" class="com.cannontech.web.amr.meter.service.impl.ServiceLocationMspMeterSearchMethodResultProvider"/>
    <bean id="eaLocationMspMeterSearchMethodResultProvider" class="com.cannontech.web.amr.meter.service.impl.EaLocationMspMeterSearchMethodResultProvider"/>
    <bean id="facilityIdMspMeterSearchMethodResultProvider" class="com.cannontech.web.amr.meter.service.impl.FacilityIdMspMeterSearchMethodResultProvider"/>
    <bean id="accountNumberMspMeterSearchMethodResultProvider" class="com.cannontech.web.amr.meter.service.impl.AccountNumberMspMeterSearchMethodResultProvider"/>
    <bean id="custIdMspMeterSearchMethodResultProvider" class="com.cannontech.web.amr.meter.service.impl.CustIdMspMeterSearchMethodResultProvider"/>
    
    <bean id="multispeakDeviceGroupSyncBackingService" class="com.cannontech.web.updater.multispeak.deviceGroupSync.MultispeakDeviceGroupSyncBackingService"/>
    
    <bean id="deviceReconfigMonitorBackingService" class="com.cannontech.web.updater.deviceReconfig.DeviceReconfigMonitorBackingService"/>
    
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.FailedCountUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.ItemsProcessedUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.NewOperationForFailedUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.NewOperationForSuccessUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.ProgressUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.StatusClassUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.StatusTextUpdaterHandler"/>
    <bean class="com.cannontech.web.updater.deviceReconfig.handler.SuccessCountUpdaterHandler"/>

    <bean id="commandScheduleValidator" class="com.cannontech.web.stars.dr.operator.inventoryOperations.CommandScheduleValidator"/>
    <bean id="filterModelValidator" class="com.cannontech.web.stars.dr.operator.inventoryOperations.FilterModelValidator"/>

	<bean id="energyCompanyInfoService" class="com.cannontech.web.admin.energyCompany.service.impl.EnergyCompanyInfoServiceImpl"/>
	<bean id="yukonUserValidator" class="com.cannontech.web.admin.userGroupEditor.model.YukonUserValidator"/>

    <!-- OPERATOR -->
    <bean id="operatorAccountService" class="com.cannontech.web.stars.dr.operator.service.impl.OperatorAccountServiceImpl"/>
    <bean id="operatorThermostatHelperImpl" class="com.cannontech.web.stars.dr.operator.service.impl.OperatorThermostatHelperImpl"/>
    <bean id="accountGeneralValidator" class="com.cannontech.web.stars.dr.operator.validator.AccountGeneralValidator"/>
    <bean id="applianceValidator" class="com.cannontech.web.stars.dr.operator.validator.ApplianceValidator"/>
    <bean id="contactDtoValidator" class="com.cannontech.web.stars.dr.operator.validator.ContactDtoValidator"/>
    <bean id="contactNotificationDtoValidator" class="com.cannontech.web.stars.dr.operator.validator.ContactNotificationDtoValidator"/>
    <bean id="customerResidenceValidator" class="com.cannontech.web.stars.dr.operator.validator.CustomerResidenceValidator"/>
    <bean id="callReportValidator" class="com.cannontech.web.stars.dr.operator.validator.CallReportValidator"/>
    <bean id="residentialLoginService" class="com.cannontech.web.stars.dr.operator.service.impl.ResidentialLoginServiceImpl"/>

    <bean id="eventLogCategoryValidator" class="com.cannontech.web.stars.dr.operator.validator.EventLogCategoryValidator"/>
    <bean id="eventLogTypeValidator" class="com.cannontech.web.stars.dr.operator.validator.EventLogTypeValidator"/>
    
  	<bean id="loginValidatorFactory" class="com.cannontech.web.stars.dr.operator.validator.impl.LoginValidatorFactoryImpl" />
  	<bean id="optOutValidatorFactory" class="com.cannontech.web.stars.dr.operator.validator.impl.OptOutValidatorFactoryImpl" />

    <bean id="displayableApplianceService" class="com.cannontech.web.stars.dr.operator.service.impl.DisplayableApplianceServiceImpl"/>
    <bean id="starsApplianceService" class="com.cannontech.stars.dr.appliance.service.impl.StarsApplianceServiceImpl"/>
    
    <bean class="com.cannontech.web.layout.PageDetailProducer"/>

    <bean id="abstractPaoPicker" class="com.cannontech.web.picker.v2.PaoPicker"
          abstract="true">
        <property name="searcher" ref="paoTypeSearcherLucene"/>
    </bean>
    <bean name="paoPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker"/>
    <bean name="programPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.LMProgramCriteria"/>
        </property>
    </bean>
    <bean name="cbcSubBusPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CBCSubBusCriteria"/>
        </property>
    </bean>
    <bean name="capControlAreaPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CapControlAreaCriteria"/>
        </property>
    </bean>
    <bean name="capBankPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CapBankCriteria"/>
        </property>
    </bean>
    <bean name="cbcPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CbcCriteria"/>
        </property>
    </bean>
    <bean name="lmDevicePicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.LMDeviceCriteria"/>
        </property>
    </bean>
    <bean name="lmProgramOrScenarioPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
           <bean class="com.cannontech.common.search.criteria.LMProgramOrScenarioCriteria"/>
        </property>  
    </bean>
    <bean name="devicePicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.DeviceCriteria"/>
        </property>
    </bean>
    <bean name="meterPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.MeterCriteria"/>
        </property>
    </bean>
    <bean name="voltageRegulatorPicker" parent="abstractPaoPicker"
        class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.VoltageRegulatorTypeCriteria"/>
        </property>
    </bean>

    <bean id="abstractPointPicker" class="com.cannontech.web.picker.v2.PointPicker"
          abstract="true">
        <property name="searcher" ref="pointDeviceSearcherLucene"/>
    </bean>
    <bean name="pointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker"/>
    <bean name="voltReductionPointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.VoltReductionCriteria"/>
        </property>
    </bean>
    <bean name="varPointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CCVarCriteria"/>
        </property>
    </bean>
    
	<bean name="filterablePointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.FilterablePointPicker">
    </bean>
    
    <bean name="wattPointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CCWattCriteria"/>
        </property>
    </bean>
    <bean name="voltPointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CCVoltCriteria"/>
        </property>
    </bean>
    <bean name="twoStatePointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.CCTwoStatePointCriteria"/>
        </property>
    </bean>
    <bean name="statusPointPicker" parent="abstractPointPicker"
        class="com.cannontech.web.picker.v2.PointPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.StatusPointCriteria"/>
        </property>
    </bean> 

	<bean name="availableCapBankPicker" class="com.cannontech.web.picker.v2.AvailableCapBankPicker"/>
	<bean name="availableVoltageRegulatorPicker" class="com.cannontech.web.picker.v2.AvailableVoltageRegulatorPicker"/>

    <bean name="userPicker" class="com.cannontech.web.picker.v2.UserPicker">
        <property name="searcher" ref="userSearcherLucene"/>
    </bean>
    <bean name="loginGroupPicker" class="com.cannontech.web.picker.v2.LoginGroupPicker">
        <property name="searcher" ref="loginGroupSearcherLucene"/>
    </bean>
    
    <bean name="twoWayLcrPicker" parent="abstractPaoPicker" class="com.cannontech.web.picker.v2.PaoPicker">
        <property name="criteria">
            <bean class="com.cannontech.common.search.criteria.TwoWayLcrCriteria"/>
        </property>
    </bean>
    
    <bean id="lmProgramForEnergyCompanyIdFilterFactory" class="com.cannontech.web.picker.v2.service.impl.LmProgramForEnergyCompanyIdFilterFactoryImpl"/>
    
    <bean name="availableMctPicker" class="com.cannontech.web.picker.v2.AvailableMctPicker"/>
    
    <bean name="availableSwitchPicker" class="com.cannontech.web.picker.v2.AvailableSwitchPicker"/>
    
    <bean name="availableThermostatPicker" class="com.cannontech.web.picker.v2.AvailableThermostatPicker"/>
    
    <bean name="availableZigbeeDevicePicker" class="com.cannontech.web.picker.v2.AvailableZigbeeDevicePicker"/>

    <bean name="applianceCategoryProgramPicker" class="com.cannontech.web.picker.v2.PaoPermissionCheckingPicker">
        <property name="permission" value="LM_VISIBLE"/>
        <property name="sqlFilters">
            <list>
                <bean class="com.cannontech.common.search.pao.db.PaoTagFilter">
                    <property name="paoTag" value="LM_PROGRAM"/>
                </bean>
                <bean class="com.cannontech.common.search.pao.db.ApplianceCategoryUsableFilter"/>
            </list>
        </property>
    </bean>
    
    <bean name="assignedProgramPicker" class="com.cannontech.web.picker.v2.AssignedProgramPicker"/>
    
    <bean name="lmDirectProgramPaoPermissionCheckingByEnergyCompanyIdPicker" class="com.cannontech.web.picker.v2.LmDirectProgramPaoPermissionCheckingByEnergyCompanyIdPicker">
    	<property name="permission" value="LM_VISIBLE"/>
    	<property name="sqlFilters">
            <list>
                <bean class="com.cannontech.common.search.pao.db.PaoTagFilter">
                    <property name="paoTag" value="LM_PROGRAM"/>
                </bean>
            </list>
        </property>
    </bean>

    <bean name="lmGroupPaoPermissionCheckingPicker" class="com.cannontech.web.picker.v2.PaoPermissionCheckingPicker">
    	<property name="permission" value="LM_VISIBLE"/>
    	<property name="sqlFilters">
            <list>
                <bean class="com.cannontech.common.search.pao.db.LmGroupFilter"/>
            </list>
        </property>
    </bean>
    
    <bean name="lmControlAreaPaoPermissionCheckingPicker" class="com.cannontech.web.picker.v2.PaoPermissionCheckingPicker">
    	<property name="permission" value="LM_VISIBLE"/>
    	<property name="sqlFilters">
            <list>
                <bean class="com.cannontech.common.search.pao.db.PaoTypeFilter">
                    <property name="paoType" value="LM_CONTROL_AREA"/>
                </bean>
            </list>
        </property>
    </bean>

    <bean name="lmScenarioPaoPermissionCheckingPicker" class="com.cannontech.web.picker.v2.PaoPermissionCheckingPicker">
    	<property name="permission" value="LM_VISIBLE"/>
    	<property name="sqlFilters">
            <list>
                <bean class="com.cannontech.common.search.pao.db.PaoTypeFilter">
                    <property name="paoType" value="LM_SCENARIO" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="databaseMigrationDIRECT_PROGRAMPicker" class="com.cannontech.web.picker.v2.DatabaseMigrationPicker">
        <property name="databaseMigrationService" ref="databaseMigrationService" />
        <property name="exportType" value="DIRECT_PROGRAM" />
        <property name="outputColumns">
            <list>
                <bean class="com.cannontech.web.picker.v2.OutputColumn">
                    <constructor-arg index="0" value="databaseMigrationDisplay" />
                    <constructor-arg index="1" value="yukon.web.picker.databaseMigrationDIRECT_PROGRAMPicker.programName" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="databaseMigrationAPP_CATEGORYPicker" class="com.cannontech.web.picker.v2.DatabaseMigrationPicker">
        <property name="databaseMigrationService" ref="databaseMigrationService" />
        <property name="exportType" value="APP_CATEGORY" />
        <property name="outputColumns">
            <list>
                <bean class="com.cannontech.web.picker.v2.OutputColumn">
                    <constructor-arg index="0" value="databaseMigrationDisplay" />
                    <constructor-arg index="1" value="yukon.web.picker.databaseMigrationAPP_CATEGORYPicker.categoryName" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="databaseMigrationEXPRESSCOM_LOAD_GROUPPicker" class="com.cannontech.web.picker.v2.DatabaseMigrationPicker">
        <property name="databaseMigrationService" ref="databaseMigrationService" />
        <property name="exportType" value="EXPRESSCOM_LOAD_GROUP" />
        <property name="outputColumns">
            <list>
                <bean class="com.cannontech.web.picker.v2.OutputColumn">
                    <constructor-arg index="0" value="databaseMigrationDisplay" />
                    <constructor-arg index="1" value="yukon.web.picker.databaseMigrationEXPRESSCOM_LOAD_GROUPPicker.groupName" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="databaseMigrationLM_GROUP_PERMISSIONSPicker" class="com.cannontech.web.picker.v2.DatabaseMigrationPicker">
        <property name="databaseMigrationService" ref="databaseMigrationService" />
        <property name="exportType" value="LM_GROUP_PERMISSIONS" />
        <property name="outputColumns">
            <list>
                <bean class="com.cannontech.web.picker.v2.OutputColumn">
                    <constructor-arg index="0" value="databaseMigrationDisplay" />
                    <constructor-arg index="1" value="yukon.web.picker.databaseMigrationLM_GROUP_PERMISSIONSPicker.groupName" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="databaseMigrationLOGIN_GROUPPicker" class="com.cannontech.web.picker.v2.DatabaseMigrationPicker">
        <property name="databaseMigrationService" ref="databaseMigrationService" />
        <property name="exportType" value="LOGIN_GROUP" />
        <property name="outputColumns">
            <list>
                <bean class="com.cannontech.web.picker.v2.OutputColumn">
                    <constructor-arg index="0" value="databaseMigrationDisplay" />
                    <constructor-arg index="1" value="yukon.web.picker.databaseMigrationLOGIN_GROUPPicker.loginGroupName" />
                </bean>
            </list>
        </property>
    </bean>

    <bean name="surveyPicker" class="com.cannontech.web.picker.v2.SurveyPicker"/>

    <bean class="org.springframework.beans.factory.config.ServiceLocatorFactoryBean">
        <property name="serviceLocatorInterface"
            value="com.cannontech.web.picker.v2.service.PickerFactory" />
    </bean>

	<bean name="customerAccountPicker" class="com.cannontech.web.picker.v2.CustomerAccountPicker"/>
	<bean name="lmHardwareBasePicker" class="com.cannontech.web.picker.v2.LmHardwareBasePicker"/>

    <bean class="com.cannontech.web.layout.impl.HttpExpressionLanguageResolverImpl"/>
    
    <bean id="flashScopeArgumentResolver" class="com.cannontech.web.common.flashScope.FlashScopeArgumentResolver"/>
    
    <bean id="accountInfoFragmentArgumentResolver" class="com.cannontech.web.stars.dr.operator.general.AccountInfoFragmentArgumentResolver"/>
    
    <bean id="energyCompanyInfoFragmentArgumentResolver" class="com.cannontech.web.admin.energyCompany.general.EnergyCompanyInfoFragmentArgumentResolver"/>
    <bean id="generalInfoService" class="com.cannontech.web.admin.energyCompany.general.service.GeneralInfoService"/>
    <bean id="generalInfoValidator" class="com.cannontech.web.admin.energyCompany.general.model.GeneralInfoValidator"/>
    <bean id="energyCompanyService" class="com.cannontech.web.admin.energyCompany.service.impl.EnergyCompanyServiceImpl"/>
    <bean id="energyCompanyDtoValidator" class="com.cannontech.web.admin.energyCompany.model.EnergyCompanyDtoValidator"/>
    
    <bean id="zoneDtoValidator" class="com.cannontech.web.capcontrol.ivvc.validators.ZoneDtoValidator"/>
	<bean id="voltageFlatnessGraphService" class="com.cannontech.web.capcontrol.ivvc.service.impl.VoltageFlatnessGraphServiceImpl"/>
    
    <bean id="hardwareDtoValidator" class="com.cannontech.web.stars.dr.operator.hardware.validator.HardwareDtoValidator"/>
    <bean id="serialNumberValidator" class="com.cannontech.web.stars.dr.operator.hardware.validator.SerialNumberValidator"/>
    <bean id="meterConfigValidator" class="com.cannontech.web.stars.dr.operator.hardware.validator.MeterConfigValidator"/>
    
    <bean id="zigbeeWebService" class="com.cannontech.stars.dr.thirdparty.digi.service.impl.DigiDummyWebServiceImpl"/>

    
    <bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
        <constructor-arg>
            <bean class="com.cannontech.web.stars.dr.operator.DigiClientHttpRequestFactory"/>
        </constructor-arg>
        <property name="errorHandler" ref="digiErrorHandler"/>
        <property name="messageConverters">
            <list>
                <bean class="org.springframework.http.converter.StringHttpMessageConverter"/>
                <bean class="org.springframework.http.converter.xml.SourceHttpMessageConverter"/>
            </list>
        </property>
    </bean>
	
	<bean id="digiErrorHandler" class="com.cannontech.web.stars.dr.operator.DigiErrorHandler">
    </bean>
    
    <bean id="accountImportResultsCache" class="com.cannontech.common.util.RecentResultsCache"/>
    <bean id="accountImportDataValidator" class="com.cannontech.web.stars.dr.operator.validator.AccountImportDataValidator"/>
    <bean id="accountImportSerivce" class="com.cannontech.web.stars.dr.operator.importAccounts.service.AccountImportService"/>
    <bean id="accountImportBackingService" class="com.cannontech.web.updater.dr.AccountImportBackingService">
        <property name="objectFormattingService" ref="objectFormattingService" />
        <property name="resultsCache" ref="accountImportResultsCache" />
    </bean>

    <bean class="com.cannontech.web.stars.dr.consumer.OptOutControllerHelper"/>    
    
    <bean id="warehouseService" class="com.cannontech.web.admin.energyCompany.warehouse.service.impl.WarehouseServiceImpl"/>
    <bean id="serviceCompanyService" class="com.cannontech.web.admin.energyCompany.serviceCompany.service.impl.ServiceCompanyServiceImpl"/>
    <bean id="serviceCompanyDtoValidator" class="com.cannontech.web.admin.energyCompany.serviceCompany.model.ServiceCompanyDtoValidator"/>
    <bean id="designationCodeDtoValidator" class="com.cannontech.web.admin.energyCompany.serviceCompany.model.DesignationCodeDtoValidator"/>
    
</beans>
