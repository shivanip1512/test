<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>
    <!--  This is a custom HandlerMapping that uses the path property from the 
          JnlpController classes to determine if the controller matches. -->
    <bean class="com.cannontech.web.jws.JnlpHandlerMapping">
      <property name="order" value="1"/>
    </bean>

    <bean class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <value>
              /*.jar=jarJnlpController
              /java=javaInstall
              /auto=ieAutoController
              /=jwsMenuController
              /opspage=jwsOpsController
            </value>
        </property>
        <property name="order" value="2"/>
    </bean>

    <bean id="viewResolver"
      class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/>
        <property name="prefix" value="/WEB-INF/pages/jws/"/>
        <property name="suffix" value=".jsp"/>
    </bean>
    
    <bean id="javaInstall" class="org.springframework.web.servlet.mvc.ParameterizableViewController">
      <property name="viewName" value="javaInstall"/>
    </bean>
    
    <bean id="ieAutoController" class="com.cannontech.web.jws.AutoDownloadController">
    </bean>
    
    <bean id="jwsMenuController" class="com.cannontech.web.jws.JwsMenuController">
      <property name="view" value="startpage"/>
    </bean>
    
    <bean id="jwsOpsController" class="com.cannontech.web.jws.JwsMenuController">
      <property name="view" value="opspage"/>
    </bean>
    
    <!--  Any instance of JnlpController will be automatically found by the menu
          controller and the mapping handler. Defining a new JWS Client only
          requires adding a bean in this section. -->
    
    <bean id="jnlpTemplate" abstract="true">
        <property name="excludedJars">
            <set>
                <value>activation.jar</value>
                <value>jsp-api.jar</value>
                <value>lucene-core-2.0.0.jar</value>
                <value>yukon-web.jar</value>
            </set>
        </property>
    </bean>
    
    <bean class="com.cannontech.web.jws.JnlpController" parent="jnlpTemplate">
        <property name="path" value="dbeditor.jnlp"/>
        <property name="appTitle" value="Database Editor"/>
        <property name="appDescription" value="Allows users to add, modify, or remove database items in the Yukon database."/>
        <property name="appMainClass" value="com.cannontech.dbeditor.DatabaseEditor"/>
        <property name="appMainClassJar" value="dbeditor.jar"/>
        <property name="appIcon" value="/WebConfig/yukon/Icons/DatabaseEditor64.gif" />
        <property name="userChecker">
          <bean factory-bean="rolePropertyUserCheckerFactory" factory-method="createRoleChecker">
            <constructor-arg value="DATABASE_EDITOR"/>
          </bean>
        </property>
    </bean>
    
    <bean class="com.cannontech.web.jws.JnlpController" parent="jnlpTemplate">
        <property name="path" value="tdc.jnlp"/>
        <property name="appTitle" value="Tabular Data Console"/>
        <property name="appDescription" value="Allows users to view real-time data in tabular format."/>
        <property name="appMainClass" value="com.cannontech.tdc.TDCMainFrame"/>
        <property name="appMainClassJar" value="tdc.jar"/>
        <property name="appIcon" value="/WebConfig/yukon/Icons/TDC64.gif" />
        <property name="userChecker">
          <bean factory-bean="rolePropertyUserCheckerFactory" factory-method="createRoleChecker">
            <constructor-arg value="TABULAR_DISPLAY_CONSOLE"/>
          </bean>
        </property>
    </bean>
    
    <bean class="com.cannontech.web.jws.JnlpController" parent="jnlpTemplate">
        <property name="path" value="trending.jnlp"/>
        <property name="appTitle" value="Trending"/>
        <property name="appDescription" value="Allows users to view real-time data in graphical format."/>
        <property name="appMainClass" value="com.cannontech.graph.GraphClient"/>
        <property name="appMainClassJar" value="graph.jar"/>
        <property name="appIcon" value="/WebConfig/yukon/Icons/GraphTrending64.gif" />
        <property name="userChecker">
          <bean factory-bean="rolePropertyUserCheckerFactory" factory-method="createRoleChecker">
            <constructor-arg value="TRENDING"/>
          </bean>
        </property>
    </bean>
    
    <bean class="com.cannontech.web.jws.JnlpController" parent="jnlpTemplate">
        <property name="path" value="esub.jnlp"/>
        <property name="appTitle" value="eSubstation Editor"/>
        <property name="appDescription" value="Allows users to create, modify, and save eSubstation drawings."/>
        <property name="appMainClass" value="com.cannontech.esub.editor.Editor"/>
        <property name="appMainClassJar" value="esub-editor.jar"/>
        <property name="appIcon" value="/WebConfig/yukon/Icons/Esubstation64.gif" />
        <property name="userChecker">
          <bean factory-bean="rolePropertyUserCheckerFactory" factory-method="createRoleChecker">
            <constructor-arg value="APPLICATION_ESUBSTATION_EDITOR"/>
          </bean>
        </property>
    </bean>
    
    <bean class="com.cannontech.web.jws.JnlpController" parent="jnlpTemplate">
        <property name="path" value="commander.jnlp"/>
        <property name="appTitle" value="Commander"/>
        <property name="appDescription" value="Allows users to send commands to field devices."/>
        <property name="appMainClass" value="com.cannontech.clientutils.commander.YukonCommander"/>
        <property name="appMainClassJar" value="yc.jar"/>
        <property name="appIcon" value="/WebConfig/yukon/Icons/Commander64.gif" />
        <property name="userChecker">
          <bean factory-bean="rolePropertyUserCheckerFactory" factory-method="createPropertyChecker">
            <constructor-arg value="ENABLE_CLIENT_COMMANDER"/>
          </bean>
        </property>
    </bean>
    
    <!--  This controller handles piping the JARs back to the JWS client. -->
    <bean id="jarJnlpController" class="com.cannontech.web.jws.JarController">
        <property name="cacheSeconds">
            <value type="int">-1</value>
        </property>
        <property name="requireSession">
            <value type="boolean">false</value>
        </property>
        <property name="synchronizeOnSession">
            <value type="boolean">false</value>
        </property>
    </bean>
</beans>
